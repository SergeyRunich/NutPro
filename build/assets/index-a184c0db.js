var he=Object.defineProperty;var me=(n,l,i)=>l in n?he(n,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[l]=i;var E=(n,l,i)=>(me(n,typeof l!="symbol"?l+"":l,i),i);import{r as u,A as H,_ as $,a1 as L,a2 as ae,c as d,j as e,aa as y,c5 as W,a3 as O,be as re,bl as h,B as w,bF as F,I as ue,aW as fe,bp as j,a as se,c6 as ge,c7 as U,a8 as ye,bg as pe,a5 as ne,b4 as De}from"./index-c20b5e8e.js";import{T as P}from"./Table-fe15f1b3.js";import"./Pagination-e2a53e90.js";import"./PickerPanel-72c5d64a.js";/* empty css              */import{R as K,C as S}from"./row-58ed805b.js";import{D as ve}from"./index-2f7554ca.js";import{S as B,a as xe}from"./index-297358d3.js";import{g as Me}from"./productionBuffer-89e10f0c.js";import{g as ke}from"./kitchen-60ac824b.js";import{C as be,A as Se,p as Ye,a as Ne,D as J}from"./index-c8879121.js";import{D as Ce}from"./index-1e692111.js";import{T as Y}from"./index-8e340a60.js";import{R as _}from"./index-48cd5627.js";import{P as ie}from"./index-67f4e7c4.js";import{D as oe}from"./index-98f1088d.js";import{r as we,i as Oe,j as Be}from"./order-d29e3517.js";import"./styleChecker-a7b568e2.js";import"./padStart-17be0050.js";var Ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M380 704h264c4.4 0 8-3.6 8-8v-84c0-4.4-3.6-8-8-8h-40c-4.4 0-8 3.6-8 8v36H428v-36c0-4.4-3.6-8-8-8h-40c-4.4 0-8 3.6-8 8v84c0 4.4 3.6 8 8 8zm340-123a40 40 0 1080 0 40 40 0 10-80 0zm239-167.6L935.3 372a8 8 0 00-10.9-2.9l-50.7 29.6-78.3-216.2a63.9 63.9 0 00-60.9-44.4H301.2c-34.7 0-65.5 22.4-76.2 55.5l-74.6 205.2-50.8-29.6a8 8 0 00-10.9 2.9L65 413.4c-2.2 3.8-.9 8.6 2.9 10.8l60.4 35.2-14.5 40c-1.2 3.2-1.8 6.6-1.8 10v348.2c0 15.7 11.8 28.4 26.3 28.4h67.6c12.3 0 23-9.3 25.6-22.3l7.7-37.7h545.6l7.7 37.7c2.7 13 13.3 22.3 25.6 22.3h67.6c14.5 0 26.3-12.7 26.3-28.4V509.4c0-3.4-.6-6.8-1.8-10l-14.5-40 60.3-35.2a8 8 0 003-10.8zM840 517v237H184V517l15.6-43h624.8l15.6 43zM292.7 218.1l.5-1.3.4-1.3c1.1-3.3 4.1-5.5 7.6-5.5h427.6l75.4 208H220l72.7-199.9zM224 581a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"car",theme:"outlined"};const Te=Ke;var de=function(l,i){return u.createElement(H,$($({},l),{},{ref:i,icon:Te}))};de.displayName="CarOutlined";const $e=u.forwardRef(de);var Pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm376 116c-119.3 0-216 96.7-216 216s96.7 216 216 216 216-96.7 216-216-96.7-216-216-216zm107.5 323.5C750.8 868.2 712.6 884 672 884s-78.8-15.8-107.5-44.5C535.8 810.8 520 772.6 520 732s15.8-78.8 44.5-107.5C593.2 595.8 631.4 580 672 580s78.8 15.8 107.5 44.5C808.2 653.2 824 691.4 824 732s-15.8 78.8-44.5 107.5zM640 812a32 32 0 1064 0 32 32 0 10-64 0zm12-64h40c4.4 0 8-3.6 8-8V628c0-4.4-3.6-8-8-8h-40c-4.4 0-8 3.6-8 8v112c0 4.4 3.6 8 8 8zM440 852H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"exception",theme:"outlined"};const Ge=Pe;var le=function(l,i){return u.createElement(H,$($({},l),{},{ref:i,icon:Ge}))};le.displayName="ExceptionOutlined";const z=u.forwardRef(le);var Ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M912 820.1V203.9c28-9.9 48-36.6 48-67.9 0-39.8-32.2-72-72-72-31.3 0-58 20-67.9 48H203.9C194 84 167.3 64 136 64c-39.8 0-72 32.2-72 72 0 31.3 20 58 48 67.9v616.2C84 830 64 856.7 64 888c0 39.8 32.2 72 72 72 31.3 0 58-20 67.9-48h616.2c9.9 28 36.6 48 67.9 48 39.8 0 72-32.2 72-72 0-31.3-20-58-48-67.9zM888 112c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zM136 912c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-752c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm704 680H184V184h656v656zm48 72c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"}},{tag:"path",attrs:{d:"M288 474h448c8.8 0 16-7.2 16-16V282c0-8.8-7.2-16-16-16H288c-8.8 0-16 7.2-16 16v176c0 8.8 7.2 16 16 16zm56-136h336v64H344v-64zm-56 420h448c8.8 0 16-7.2 16-16V566c0-8.8-7.2-16-16-16H288c-8.8 0-16 7.2-16 16v176c0 8.8 7.2 16 16 16zm56-136h336v64H344v-64z"}}]},name:"group",theme:"outlined"};const _e=Ie;var ce=function(l,i){return u.createElement(H,$($({},l),{},{ref:i,icon:_e}))};ce.displayName="GroupOutlined";const ze=u.forwardRef(ce);var Q;let I=L(Q=class extends ae.Component{render(){const{title:l,type:i,generated:f,shouldBe:g,date:M,generatedSecond:D,shouldBeSecond:m,dateSecond:k,intl:{formatMessage:t}}=this.props;return d("div",{className:"card card--fullHeight",children:[e("div",{className:"card-header",children:e("div",{className:"utils__title utils__title--flat",children:e("strong",{className:"text-uppercase font-size-16",children:l})})}),e("div",{className:"card-body",children:d(K,{gutter:16,children:[d(S,{span:12,children:[i==="production"&&e(B,{title:y.unix(M).format("DD.MM.YYYY"),value:f,suffix:`/ ${g}`,prefix:e(W,{})}),i==="error"&&e(B,{title:y.unix(M).format("DD.MM.YYYY"),value:f,prefix:e(z,{})}),i==="summary"&&e(B,{title:"Delivery",value:f,prefix:e($e,{})})]}),d(S,{span:12,children:[i==="production"&&e(B,{title:y.unix(k).format("DD.MM.YYYY"),value:D,suffix:`/ ${m}`,prefix:e(W,{})}),i==="error"&&e(B,{title:y.unix(k).format("DD.MM.YYYY"),value:D,prefix:e(z,{})}),i==="summary"&&e(B,{title:t({id:"StatisticCard.TotalSets"}),value:D,suffix:`/ ${m}`,prefix:e(ze,{})})]})]})})]})}})||Q;var X;let Le=L(X=class extends ae.Component{constructor(i){super(i);E(this,"state",{isChecked:!1,loading:!0,kitchens:[],buffers:[]});E(this,"checkBuffer",async()=>{const{kitchens:i}=this.state;let{buffers:f}=this.state;const{timestamp:g,intl:{formatMessage:M}}=this.props;f=[];for(const D of i)this.setState({isChecked:!1}),Me(y.unix(g).format("DD-MM-YYYY"),D.id).then(async m=>{if(m.ok){const k=await m.json();f.push(k.result),this.setState({buffers:f,isChecked:!0,loading:!1})}else O.error({message:M({id:"window.error"}),description:m.statusText})})});this.checkBuffer=this.checkBuffer.bind(this)}componentDidMount(){ke().then(async i=>{const f=await i.json();this.setState({kitchens:f}),this.checkBuffer()})}render(){const{title:i}=this.props,{isChecked:f,buffers:g,kitchens:M,loading:D}=this.state;return d("div",{className:"card card--fullHeight",children:[e("div",{className:"card-header",children:e("div",{className:"utils__title utils__title--flat",children:e("strong",{className:"text-uppercase font-size-16",children:i})})}),d("div",{className:"card-body",children:[f&&!D&&e(K,{gutter:16,children:g&&g.map(m=>d(S,{span:12,children:[g.length>1&&g[0].maxValue!==0&&e(B,{title:M.find(k=>k.id===m.kitchen).name,value:m.currentValue,suffix:`/ ${m.maxValue}`,prefix:e(z,{})}),g.length>1&&g[0].maxValue===0&&e(B,{title:M.find(k=>k.id===m.kitchen).name,value:m.currentValue,suffix:"/ âˆž",prefix:e(z,{})})]},m.kitchen.name))}),D&&e(K,{gutter:16,children:e(xe,{})})]})]})}})||X;function Re(n){const[l,i]=u.useState([]),[f,g]=u.useState([]),[M,D]=u.useState(!1),[m,k]=u.useState(""),[t,C]=u.useState(!1);u.useEffect(()=>{i(n.cookingData.firstDay.generated.concat(n.cookingData.secondDay.generated)),g(n.cookingData.firstDay.generated.concat(n.cookingData.secondDay.generated))},[n.cookingData.firstDay.generated,n.cookingData.secondDay.generated]);const s=a=>{k(a.target.value)},p=a=>{let r=n.cookingData.firstDay.generated.concat(n.cookingData.secondDay.generated);a===1?r=n.cookingData.firstDay.generated:a===2&&(r=n.cookingData.secondDay.generated),i(r),g(r)},b=()=>{const a=new RegExp(m,"gi");D(!1),C(!!m),g(l.map(r=>{const x=r.user.name.match(a);return x?{...r,name:e("span",{children:r.user.name.split(a).map((G,R)=>R>0?[e("span",{className:"highlight",children:x[0]},Math.random()),G]:G)})}:null}).filter(r=>!!r)),m===""&&C(!1)},c=u.useRef(null);u.useEffect(()=>{c.current&&c.current.focus()},[M]);const v=()=>{n.onClose()},N=[{title:e(h,{id:"window.name"}),dataIndex:"order",key:"name",render:(a,r)=>e(F,{to:`/orders/${a.id}`,children:` ${r.user.name}`}),filterDropdown:d("div",{className:"custom-filter-dropdown",children:[e(ue,{ref:c,placeholder:"Search name",value:m,onChange:s,onPressEnter:b}),e(w,{type:"primary",onClick:b,children:e(h,{id:"KitchenGeneratedMacro.Search"})})]}),filterIcon:e(fe,{style:{color:t?"#108ee9":"#aaa"}}),filterDropdownVisible:M,onFilterDropdownVisibleChange:a=>{D(a)}},{title:e(h,{id:"KitchenGeneratedMacro.MealsP/d"}),dataIndex:"order",key:"meals",render:a=>e("span",{children:`${a.mealsPerDay}`}),sorter:(a,r)=>a.order.mealsPerDay-r.order.mealsPerDay},{title:e(h,{id:"KitchenGeneratedMacro.IgnoredMeals"}),dataIndex:"order",key:"ignored",render:a=>e("span",{children:`${a.ignoredMealTypes.length}`}),sorter:(a,r)=>a.order.ignoredMealTypes.length-r.order.ignoredMealTypes.length},{title:e(h,{id:"KitchenGeneratedMacro.kCal"}),dataIndex:"dayShouldBe",key:"kCal",render:a=>e(Y,{color:"geekblue",children:Math.round(a.kcal)},"dfsdsds"),sorter:(a,r)=>a.dayShouldBe.kcal-r.dayShouldBe.kcal},{title:e(h,{id:"KitchenGeneratedMacro.Prot"}),dataIndex:"dayShouldBe",key:"prot",render:a=>e(Y,{color:"geekblue",children:Math.round(a.prot)},"dfdfdfdfe"),sorter:(a,r)=>a.dayShouldBe.prot-r.dayShouldBe.prot},{title:e(h,{id:"KitchenGeneratedMacro.Fat"}),dataIndex:"dayShouldBe",key:"fat",render:a=>e(Y,{color:"geekblue",children:Math.round(a.fat)},"3343fe"),sorter:(a,r)=>a.dayShouldBe.fat-r.dayShouldBe.fat},{title:e(h,{id:"KitchenGeneratedMacro.Carb"}),dataIndex:"dayShouldBe",key:"carb",render:a=>e(Y,{color:"geekblue",children:Math.round(a.carb)},"dfdfe33"),sorter:(a,r)=>a.dayShouldBe.fat-r.dayShouldBe.fat},{title:e(h,{id:"KitchenGeneratedMacro.kCal(G)"}),dataIndex:"nutrients",key:"kCal-nutr",render:(a,r)=>{const x=Math.abs(r.kcalTh)<=10?"green":Math.abs(r.kcalTh)<=20?"orange":"red";return e(Y,{color:x,children:Math.round(a.kcal)},"fdfd44thde")},sorter:(a,r)=>a.nutrients.kcal-r.nutrients.kcal},{title:e(h,{id:"KitchenGeneratedMacro.Prot(G)"}),dataIndex:"nutrients",key:"prot-nutr",render:(a,r)=>{const x=Math.abs(r.protTh)<=10?"green":Math.abs(r.protTh)<=20?"orange":"red";return e(Y,{color:x,children:Math.round(a.prot)},Math.random())},sorter:(a,r)=>a.nutrients.prot-r.nutrients.prot},{title:e(h,{id:"KitchenGeneratedMacro.Fat(G)"}),dataIndex:"nutrients",key:"fat-nutr",render:(a,r)=>{const x=Math.abs(r.fatTh)<=10?"green":Math.abs(r.fatTh)<=20?"orange":"red";return e(Y,{color:x,children:Math.round(a.fat)},Math.random())},sorter:(a,r)=>a.nutrients.fat-r.nutrients.fat},{title:e(h,{id:"KitchenGeneratedMacro.Carb(G)"}),dataIndex:"nutrients",key:"carb-nutr",render:(a,r)=>{const x=Math.abs(r.carbTh)<=10?"green":Math.abs(r.carbTh)<=20?"orange":"red";return e(Y,{color:x,children:Math.round(a.carb)},Math.random())},sorter:(a,r)=>a.nutrients.carb-r.nutrients.carb},{title:e(h,{id:"KitchenGeneratedMacro.%kCal"}),dataIndex:"kcalTh",key:"kcalTh",render:a=>e("span",{children:`${a}`}),sorter:(a,r)=>Math.abs(a.kcalTh)-Math.abs(r.kcalTh)},{title:e(h,{id:"KitchenGeneratedMacro.%Prot"}),dataIndex:"protTh",key:"protTh",render:a=>e("span",{children:`${a}`}),sorter:(a,r)=>Math.abs(a.protTh)-Math.abs(r.protTh)},{title:e(h,{id:"KitchenGeneratedMacro.%Fat"}),dataIndex:"fatTh",key:"fatTh",render:a=>e("span",{children:`${a}`}),sorter:(a,r)=>Math.abs(a.fatTh)-Math.abs(r.fatTh)},{title:e(h,{id:"KitchenGeneratedMacro.%Carb"}),dataIndex:"carbTh",key:"carbTh",render:a=>e("span",{children:`${a}`}),sorter:(a,r)=>Math.abs(a.carbTh)-Math.abs(r.carbTh)}];return e("div",{children:d(Ce,{title:e(h,{id:"KitchenGeneratedMacro.NutrientsError"}),width:"100%",onClose:v,open:n.macroVisible,bodyStyle:{paddingBottom:80},children:[e(w,{style:{marginRight:"15px",marginBottom:"30px"},type:"primary",onClick:()=>p(0),children:e(h,{id:"KitchenGeneratedMacro.AllDays"})}),e(w,{style:{marginRight:"15px",marginBottom:"30px"},type:"primary",onClick:()=>p(1),children:y.unix(n.cookingData.firstDay.timestamp).format("DD.MM.YYYY")}),e(w,{style:{marginRight:"15px",marginBottom:"30px"},type:"primary",onClick:()=>p(2),children:y.unix(n.cookingData.secondDay.timestamp).format("DD.MM.YYYY")}),e(P,{className:"utils__scrollTable",tableLayout:"auto",scroll:{x:"100%"},columns:N,dataSource:f,pagination:{position:"bottom",total:f.length,showTotal:(a,r)=>`${r[0]}-${r[1]} of ${a} items`,showSizeChanger:!0,pageSizeOptions:["10","20","50","100","200"],hideOnSinglePage:f.length<10},rowKey:()=>Math.random()})]})})}const Ee=re(L(Re));function Ae(n){const[l,i]=u.useState([]),[f,g]=u.useState(!1),[M,D]=u.useState(!1),m=(s,p)=>{Oe(s).then(b=>{b.ok?(l.push(p),i(l)):O.error({message:`Error code: ${b.status}`})})},k=s=>{D(!0),we(s).then(p=>{p.ok?(g(!0),D(!1)):O.error({message:`Error code: ${p.status}`})})},t={orderId:n.data.map(s=>s.id)},C=[{title:e(h,{id:"window.name"}),dataIndex:"id",key:"name",render:(s,p)=>e(F,{to:`/orders/${s}`,children:` ${p.user.name}`})},{title:e(h,{id:"KitchenOrderList.Kitchen"}),dataIndex:"kitchen",key:"kitchen",render:s=>e("span",{children:`${s}`})},{title:e(h,{id:"KitchenOrderList.Meals"}),dataIndex:"mealsPerDay",key:"meals",render:s=>e("span",{children:`${s}`}),sorter:(s,p)=>s.mealsPerDay-p.mealsPerDay},{title:e(h,{id:"KitchenOrderList.Week"}),dataIndex:"size",key:"size",render:s=>e("span",{children:`${s}`})},{title:e(h,{id:"KitchenOrderList.Skip#"}),dataIndex:"ignoredMealTypes",key:"ignoredMealTypes",render:s=>e("span",{children:`${s.length||"-"}`})},{title:e(h,{id:"KitchenOrderList.Tags"}),dataIndex:"tags",key:"tags",render:s=>s.map(p=>e(Y,{color:"cyan",children:p},Math.random()))}];return n.regenButton&&C.push({title:"---",dataIndex:"id",key:"remove",render:(s,p,b)=>d(j,{children:[l.indexOf(b)===-1&&e(ie,{title:"Are you sure?",onConfirm:()=>m(s,b),okText:"Yes",cancelText:"No",children:e(w,{type:"primary",children:e(h,{id:"KitchenOrderList.Regenerate"})})}),l.indexOf(b)!==-1&&e(Y,{color:"green",children:e(h,{id:"KitchenOrderList.Regenerated"})})]})}),d("div",{className:"card card--fullHeight",children:[e("div",{className:"card-header",children:e("div",{className:"utils__title utils__title--flat",children:e("strong",{className:"text-uppercase font-size-16",children:n.title||""})})}),d("div",{className:"card-body",children:[n.title&&n.title==="Missing orders"&&t.orderId.length?e(oe,{children:e(w,{type:"primary",loading:M,onClick:()=>k(t),children:e(h,{id:"KitchenOrderList.RegenerateAll"})})}):"",n.data.length!==0&&!f&&e(P,{className:"utils__scrollTable",tableLayout:"auto",scroll:{x:"100%"},columns:C,dataSource:n.data,pagination:{position:"bottom",total:n.data.length,showTotal:(s,p)=>`${p[0]}-${p[1]} of ${s} items`,showSizeChanger:!0,pageSizeOptions:["10","20","50","100","200"],hideOnSinglePage:n.data.length<10},rowKey:()=>Math.random()}),n.title==="Missing orders"&&f?e(_,{status:"success",title:e(h,{id:"KitchenOrderList.RegenerationInProgress"})}):n.data.length===0&&e(_,{status:"success",title:e(h,{id:"KitchenOrderList.SuccessfullyChecked!"})})]})]})}const A=re(L(Ae)),Ve=({title:n,data:l})=>{const[i,f]=u.useState([]),[g,M]=u.useState(!1),[D,m]=u.useState(!1),k=se(),{formatMessage:t}=k,C=async(c,v)=>{try{const N=await ge(c);N.status===200?f([...i,v]):O.error({message:`Error code: ${N.status}`})}catch{O.error({message:t({id:"window.error"}),description:"Failed to remove order"})}},s=async c=>{try{M(!0);const v=await Be(c);v.status===200?(m(!0),M(!1),f([])):O.error({message:`Error code: ${v.status}`})}catch{O.error({message:t({id:"window.error"}),description:"Failed to remove all orders"})}finally{M(!1)}},p={dayId:l.map(c=>c.id)},b=[{title:t({id:"window.name"}),dataIndex:"user",key:"name",render:(c,v)=>e(F,{to:`/orders/${v.order.id}`,children:` ${c.name}`})},{title:t({id:"KitchenGeneratedOrderList.Kitchen"}),dataIndex:"kitchen",key:"kitchen",render:c=>e("span",{children:`${c}`})},{title:t({id:"window.date"}),dataIndex:"timestamp",key:"timestamp",render:c=>e("span",{children:y.unix(c).format("DD.MM (ddd)")})},{title:t({id:"KitchenGeneratedOrderList.Meals"}),dataIndex:"order",key:"meals",render:c=>e("span",{children:`${c.mealsPerDay}`}),sorter:(c,v)=>c.mealsPerDay-v.mealsPerDay},{title:t({id:"KitchenGeneratedOrderList.Week"}),dataIndex:"order",key:"size",render:c=>e("span",{children:`${c.size}`})},{title:t({id:"KitchenGeneratedOrderList.Skip#"}),dataIndex:"order",key:"ignoredMealTypes",render:c=>e("span",{children:`${c.ignoredMealTypes.length||"-"}`})},{title:t({id:"KitchenGeneratedOrderList.Tags"}),dataIndex:"tags",key:"tags",render:c=>c.map(v=>e(Y,{color:"cyan",children:v},Math.random()))},{title:"---",dataIndex:"id",key:"remove",render:(c,v,N)=>d(j,{children:[i.indexOf(N)===-1&&e(ie,{title:"Are you sure?",onConfirm:()=>C(c,N),okText:"Yes",cancelText:"No",children:e(w,{type:"primary",danger:!0,children:t({id:"window.remove"})})}),i.indexOf(N)!==-1&&e(Y,{color:"green",children:t({id:"KitchenGeneratedOrderList.Removed"})})]})}];return d("div",{className:"card card--fullHeight",children:[e("div",{className:"card-header",children:e("div",{className:"utils__title utils__title--flat",children:e("strong",{className:"text-uppercase font-size-16",children:n||""})})}),d("div",{className:"card-body",children:[!D&&l.length!==0&&e(oe,{children:e(w,{type:"danger",loading:g,onClick:()=>s(p),children:t({id:"KitchenGeneratedOrderList.RemoveAll"})})}),l.length!==0&&!D&&e(P,{className:"utils__scrollTable",tableLayout:"auto",scroll:{x:"100%"},columns:b,dataSource:l,pagination:{position:"bottom",total:l.length,showTotal:(c,v)=>`${v[0]}-${v[1]} of ${c} items`,showSizeChanger:!0,pageSizeOptions:["10","20","50","100","200"],hideOnSinglePage:l.length<10},rowKey:()=>Math.random().toString()}),D&&e(_,{status:"success",title:t({id:"KitchenGeneratedOrderList.SuccessfullyRemoved!"})}),l.length===0&&e(_,{status:"success",title:t({id:"KitchenGeneratedOrderList.SuccessfullyChecked!"})})]})]})},Z=["Below 5%","From 5% to 10%","From 10% to 15%","From 15% to 20%","Above 20%"],q=["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],ee=["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],te={plugins:{legend:{display:!1}}};y.updateLocale("en",{week:{dow:1}});be.register(Se,Ye,Ne);const{Option:V}=ne,{RangePicker:He}=ve,ft=()=>{const[n,l]=u.useState(0),[i,f]=u.useState(["",""]),[g]=u.useState(!0),[M,D]=u.useState(!1),[m,k]=u.useState(!0),[t,C]=u.useState({firstDay:{timestamp:0,kitchens:[{name:"",total:0,reserve:0,pickupPoint:0,shouldBe:0},{name:"",total:0,reserve:0,pickupPoint:0,shouldBe:0}],shouldBe:[],generated:[],totalShouldBe:0,totalGenerated:0,shouldBeUsers:[],generatedUsers:[],usersShouldBe:0,usersGenerated:0,reserve:0,pickupPoint:0,errors:{missingOrders:[],extraOrders:[],missingMeals:[],extraMeals:[],meals:[],macro:{max5:{data:[],total:0},max10:{data:[],total:0},max15:{data:[],total:0},max20:{data:[],total:0},other:{data:[],total:0},total:0}}},secondDay:{timestamp:0,kitchens:[{name:"",total:0,reserve:0,pickupPoint:0,shouldBe:0,vege:0},{name:"",total:0,reserve:0,pickupPoint:0,shouldBe:0,vege:0}],shouldBe:[],generated:[],totalShouldBe:0,totalGenerated:0,shouldBeUsers:[],generatedUsers:[],usersShouldBe:0,usersGenerated:0,reserve:0,pickupPoint:0,errors:{missingOrders:[],extraOrders:[],missingMeals:[],extraMeals:[],meals:[],macro:{max5:{data:[],total:0},max10:{data:[],total:0},max15:{data:[],total:0},max20:{data:[],total:0},other:{data:[],total:0},total:0}}},totalCooking:0}),{formatMessage:s}=se();u.useEffect(()=>{U(n,i,g).then(async o=>{if(o.status===200){const T=await o.json();C(T)}else O.error({message:s({id:"window.error"}),description:o.statusText});k(!1)})},[i,g,n]);const p=()=>{k(!0),U(n,i,g).then(async o=>{if(o.status===200){const T=await o.json();C(T)}else O.error({message:s({id:"window.error"}),description:o.statusText});k(!1)})},b=o=>{if(!i[0]||i.length===0)return!1;const T=y(i[0],"DD-MM-YYYY")&&o.diff(y(i[0],"DD-MM-YYYY"),"days")>1;return y(i[1],"DD-MM-YYYY")&&y(i[1],"DD-MM-YYYY").diff(o,"days")>1||T},c=()=>D(!0),v=()=>D(!1),N=()=>{const o=[n[0].format("DD-MM-YYYY"),n[1].format("DD-MM-YYYY")];f(o)},a=o=>{const T=o[1]?o[1].format("DD-MM-YYYY"):"";f([o[0].format("DD-MM-YYYY"),T])},r=[{title:s({id:"KitchenDashboard.Range"}),dataIndex:"type",key:"type"},{title:s({id:"KitchenDashboard.Amount"}),key:"amount",dataIndex:"amount",render:o=>e("span",{className:"text-primary font-weight-bold",children:o})}],x=[0,0];t.firstDay.reserve>0&&(x[0]+=1),t.firstDay.pickupPoint>0&&(x[0]+=1),t.secondDay.reserve>0&&(x[1]+=1),t.secondDay.pickupPoint>0&&(x[1]+=1);const G={labels:Z,datasets:[{data:[t.firstDay.errors.macro.max5.total,t.firstDay.errors.macro.max10.total,t.firstDay.errors.macro.max15.total,t.firstDay.errors.macro.max20.total,t.firstDay.errors.macro.other.total],backgroundColor:q,borderColor:ee,borderWidth:1}]},R={labels:Z,datasets:[{data:[t.secondDay.errors.macro.max5.total,t.secondDay.errors.macro.max10.total,t.secondDay.errors.macro.max15.total,t.secondDay.errors.macro.max20.total,t.secondDay.errors.macro.other.total],backgroundColor:q,borderColor:ee,borderWidth:1}]};return d(ye,{roles:["admin","root","salesDirector"],users:["Vitaly"],redirect:!0,to:"/main",children:[e(pe,{title:s({id:"KitchenDashboard.DashboardKitchen"})}),e("div",{className:"row",children:e("div",{className:"col-xl-12",children:e("div",{className:"card card--fullHeight",children:d("div",{className:"card-body",children:[d(ne,{labelInValue:!0,defaultValue:{key:"0"},style:{marginBottom:"15px",marginRight:"10px"},onChange:o=>l(o.key),loading:m,children:[e(V,{value:"0",children:s({id:"KitchenDashboard.FinalOrder"})},0),e(V,{value:"1",children:s({id:"KitchenDashboard.Preorder"})},1),e(V,{value:"2",children:s({id:"KitchenDashboard.CustomRange"})},2)]}),Number(n)===2&&e("span",{children:e(He,{ranges:{"Previous Month":[y().subtract(1,"month").startOf("month"),y().subtract(1,"month").endOf("month")],"This Month":[y().startOf("month"),y().endOf("month")]},format:"DD.MM.YYYY",style:{marginRight:"10px"},disabledDate:b,onChange:N,onCalendarChange:a})}),e(w,{onClick:p,type:"primary",style:{marginRight:"10px"},loading:m,disabled:m,children:s({id:"KitchenDashboard.View"})}),e("span",{style:{marginLeft:"15px",fontSize:"18px"},children:e("strong",{children:`${y.unix(t.firstDay.timestamp).format("DD.MM.YYYY")}
                 -
                ${y.unix(t.secondDay.timestamp).format("DD.MM.YYYY")}`})}),e(w,{style:{float:"right"},type:"default",onClick:c,children:s({id:"KitchenDashboard.ShowMacro"})})]})})})}),m&&e("center",{children:e(De,{})}),!m&&d(j,{children:[d("div",{className:"row",children:[e("div",{className:"col-xl-4 col-md-6",children:e(I,{title:s({id:"KitchenDashboard.Summary"}),type:"summary",generated:t.firstDay.usersShouldBe,shouldBeSecond:t.firstDay.totalShouldBe+t.secondDay.totalShouldBe,generatedSecond:`${t.firstDay.totalGenerated+t.secondDay.totalGenerated-t.firstDay.reserve-t.secondDay.reserve-t.firstDay.pickupPoint-t.secondDay.pickupPoint} (+${t.firstDay.reserve+t.secondDay.reserve+t.firstDay.pickupPoint+t.secondDay.pickupPoint})`})}),e("div",{className:"col-xl-4 col-md-6",children:e(I,{title:s({id:"KitchenDashboard.ProductionStatus"}),type:"production",generated:t.firstDay.reserve+t.firstDay.pickupPoint>0?`${t.firstDay.totalGenerated-t.firstDay.reserve-t.firstDay.pickupPoint} (+${t.firstDay.reserve+t.firstDay.pickupPoint})`:t.firstDay.totalGenerated,shouldBe:t.firstDay.totalShouldBe,date:t.firstDay.timestamp,generatedSecond:t.secondDay.reserve+t.secondDay.pickupPoint>0?`${t.secondDay.totalGenerated-t.secondDay.reserve+t.secondDay.pickupPoint} (+${t.secondDay.reserve+t.secondDay.pickupPoint})`:t.secondDay.totalGenerated,shouldBeSecond:t.secondDay.totalShouldBe,dateSecond:t.secondDay.timestamp})}),e("div",{className:"col-xl-4 col-md-6",children:e(I,{title:s({id:"KitchenDashboard.Customers"}),type:"production",generated:t.firstDay.reserve+t.firstDay.pickupPoint>0?`${t.firstDay.usersGenerated-x[0]} (+${x[0]})`:t.firstDay.usersGenerated,shouldBe:t.firstDay.usersShouldBe,reserve:t.firstDay.reserve,reserveSecond:t.secondDay.reserve,date:t.firstDay.timestamp,generatedSecond:t.secondDay.reserve+t.secondDay.pickupPoint>0?`${t.secondDay.usersGenerated-x[1]} (+${x[1]})`:t.secondDay.usersGenerated,shouldBeSecond:t.secondDay.usersShouldBe,dateSecond:t.secondDay.timestamp})}),e("div",{className:"col-xl-4 col-md-6",children:d("div",{className:"card card--fullHeight",children:[e("div",{className:"card-header",children:e("div",{className:"utils__title utils__title--flat",children:e("strong",{className:"text-uppercase font-size-16",children:s({id:"KitchenDashboard.KitchenStatus"})})})}),d("div",{className:"card-body",children:[d(K,{gutter:16,children:[e(S,{span:8,children:e("strong",{children:s({id:"KitchenDashboard.Kitchen"})})}),e(S,{span:8,children:e("strong",{children:y.unix(t.firstDay.timestamp).format("DD.MM.YYYY")})}),e(S,{span:8,children:e("strong",{children:y.unix(t.secondDay.timestamp).format("DD.MM.YYYY")})})]}),d(K,{gutter:16,children:[e(S,{span:8,children:t&&t.firstDay&&t.firstDay.kitchens.slice(0,-1).map(o=>e(K,{gutter:16,children:e(S,{span:24,children:e("strong",{children:o.name})})},o.name))}),e(S,{span:8,children:t&&t.firstDay&&t.firstDay.kitchens.slice(0,-1).map(o=>e(K,{gutter:16,children:d(S,{span:24,children:[o.total-o.reserve-o.pickupPoint," (+",o.reserve+o.pickupPoint,") / ",o.shouldBe,o.vege>0?"ðŸ¥¦":""]})},o.name))}),e(S,{span:8,children:t&&t.secondDay&&t.secondDay.kitchens.slice(0,-1).map(o=>e(K,{gutter:16,children:d(S,{span:24,children:[o.total-o.reserve-o.pickupPoint," (+",o.reserve+o.pickupPoint,") / ",o.shouldBe,o.vege>0?"ðŸ¥¦":""]})},o.name))})]})]})]})}),e("div",{className:"col-xl-4 col-md-6",children:e(I,{title:s({id:"KitchenDashboard.ErrorCal>20%"}),type:"error",generated:t.firstDay.errors.macro.other.total,generatedSecond:t.secondDay.errors.macro.other.total,date:t.firstDay.timestamp,dateSecond:t.secondDay.timestamp})}),e("div",{className:"col-xl-4 col-md-6",children:e(Le,{title:s({id:"KitchenDashboard.Buffer"}),timestamp:t.firstDay.timestamp,timestamp2:t.secondDay.timestamp})})]}),e("div",{className:"utils__title mb-3",children:e("strong",{className:"text-uppercase font-size-16",children:s({id:"KitchenDashboard.Orders"})})}),d("div",{className:"row",children:[e("div",{className:"col-lg-6",children:e(A,{title:"Missing orders",data:t.firstDay.errors.missingOrders,regenButton:!0})}),e("div",{className:"col-lg-6",children:e(Ve,{title:"Extra orders",data:t.firstDay.errors.extraOrders.concat(t.secondDay.errors.extraOrders)})})]}),e("div",{className:"utils__title mb-3",children:e("strong",{className:"text-uppercase font-size-16",children:s({id:"KitchenDashboard.Meals"})})}),d("div",{className:"row",children:[e("div",{className:"col-lg-6",children:e(A,{title:"Missing meals",data:t.firstDay.errors.missingMeals,regenButton:!0})}),e("div",{className:"col-lg-6",children:e(A,{title:s({id:"KitchenDashboard.ExtraMeals"}),data:t.firstDay.errors.extraMeals.concat(t.secondDay.errors.extraMeals)})})]}),g&&d("div",{className:"row",children:[e("div",{className:"col-xl-6",children:d("div",{className:"card card--fullHeight",children:[e("div",{className:"card-header",children:e("div",{className:"utils__title utils__title--flat",children:d("strong",{className:"text-uppercase font-size-16",children:[s({id:"KitchenDashboard.ErrorInCaloriesSPACE"}),y.unix(t.firstDay.timestamp).format("DD.MM.YYYY")]})})}),e("div",{className:"card-body",children:d("div",{className:"row",children:[e("div",{className:"col-xl-6",children:e("div",{className:"mb-3",children:e(P,{className:"utils__scrollTable",scroll:{x:"100%"},rowKey:()=>Math.random().toString(),dataSource:[{key:"1",type:"Below 5%",amount:t.firstDay.errors.macro.max5.total},{key:"2",type:"From 5 to 10",amount:t.firstDay.errors.macro.max10.total},{key:"3",type:"From 10 to 15",amount:t.firstDay.errors.macro.max15.total},{key:"4",type:"From 15 to 20",amount:t.firstDay.errors.macro.max20.total},{key:"5",type:"Above 20%",amount:t.firstDay.errors.macro.other.total}],columns:r,pagination:!1})})}),e("div",{className:"col-xl-6 d-flex align-items-center justify-content-center",children:e("div",{className:" d-flex justify-content-center w-75",style:{marginBottom:"5px"},children:e(J,{data:G,options:te})})})]})})]})}),e("div",{className:"col-xl-6",children:d("div",{className:"card card--fullHeight",children:[e("div",{className:"card-header",children:e("div",{className:"utils__title utils__title--flat",children:d("strong",{className:"text-uppercase font-size-16",children:[s({id:"KitchenDashboard.ErrorInCaloriesSPACE"}),y.unix(t.secondDay.timestamp).format("DD.MM.YYYY")]})})}),e("div",{className:"card-body",children:d("div",{className:"row",children:[e("div",{className:"col-xl-6",children:e("div",{className:"mb-3",children:e(P,{className:"utils__scrollTable",scroll:{x:"100%"},rowKey:()=>Math.random().toString(),dataSource:[{key:"1",type:"Below 5%",amount:t.secondDay.errors.macro.max5.total},{key:"2",type:"From 5 to 10",amount:t.secondDay.errors.macro.max10.total},{key:"3",type:"From 10 to 15",amount:t.secondDay.errors.macro.max15.total},{key:"4",type:"From 15 to 20",amount:t.secondDay.errors.macro.max20.total},{key:"5",type:"Above 20%",amount:t.secondDay.errors.macro.other.total}],columns:r,pagination:!1})})}),e("div",{className:"col-xl-6 d-flex  align-items-center justify-content-center",children:e("div",{className:"d-flex justify-content-center w-75",style:{marginBottom:"5px"},children:e(J,{data:R,options:te})})})]})})]})})]})]}),e(Ee,{macroVisible:M,onClose:v,cookingData:t})]})};export{ft as default};
