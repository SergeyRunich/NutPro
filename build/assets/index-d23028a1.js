import{be as z,a1 as y,j as e,bl as t,aa as s,c as o,T as O,B as m,r as f,dr as w,bq as j,a3 as u,a8 as E,bg as F,a5 as b,ds as B,dt as K}from"./index-c20b5e8e.js";import"./PickerPanel-72c5d64a.js";/* empty css              */import{D as R}from"./index-2f7554ca.js";import{T as X}from"./Table-fe15f1b3.js";import"./Pagination-e2a53e90.js";import"./index-8e340a60.js";import"./styleChecker-a7b568e2.js";function H(d){return e("div",{children:e(X,{className:"utils__scrollTable",tableLayout:"auto",scroll:{x:"100%"},columns:[{title:e(t,{id:"TableOfOrders.DateAccepted"}),dataIndex:"date",key:"accept_date",render:(n,i)=>s(i.accept_date).format("DD.MM.YYYY")},{title:e(t,{id:"TableOfOrders.DueDate"}),dataIndex:"date",key:"due_date",render:(n,i)=>s(i.due_date).format("DD.MM.YYYY")},{title:e(t,{id:"TableOfOrders.Invoice"}),dataIndex:"invoice",key:"invoice",render:n=>n.number?e("a",{href:n.public_url,target:"blank",children:n.number}):"none"},{title:e(t,{id:"window.name"}),dataIndex:"name",key:"name",render:n=>e("span",{children:`${n}`})},{title:e(t,{id:"TableOfOrders.Amount"}),dataIndex:"amount",key:"amount",render:n=>e("center",{children:o("span",{children:[`${n}`,"KÄ"]})})},{title:e(t,{id:"TableOfOrders.N1"}),dataIndex:"notifications",key:"notification1",render:(n,i)=>e("center",{children:i.notifications[0]!==null?e(O,{title:s(i.notifications[0]).format("DD.MM.YYYY"),children:e("center",{children:e(t,{id:"TableOfOrders.Sent"})})}):e(t,{id:"TableOfOrders.NotSent"})})},{title:e(t,{id:"TableOfOrders.N2"}),dataIndex:"notifications",key:"notification2",render:(n,i)=>e("center",{children:i.notifications[1]!==null?e(O,{title:s(i.notifications[1]).format("DD.MM.YYYY"),children:e("center",{children:e(t,{id:"TableOfOrders.Sent"})})}):e(t,{id:"TableOfOrders.NotSent"})})},{title:e(t,{id:"TableOfOrders.N3"}),dataIndex:"notifications",key:"notification3",render:(n,i)=>e("center",{children:i.notifications[2]!==null?e(O,{title:s(i.notifications[2]).format("DD.MM.YYYY"),children:e("center",{children:e(t,{id:"TableOfOrders.Sent"})})}):e(t,{id:"TableOfOrders.NotSent"})})},{title:e(t,{id:"TableOfOrders.N4"}),dataIndex:"notifications",key:"notification4",render:(n,i)=>e("center",{children:i.notifications[3]!==null?e(O,{title:s(i.notifications[3]).format("DD.MM.YYYY"),children:e("center",{children:e(t,{id:"TableOfOrders.Sent"})})}):e(t,{id:"TableOfOrders.NotSent"})})},{title:e(t,{id:"TableOfOrders.SendToDebtCollector"}),dataIndex:"send_to_collector",key:"send_to_collector",render:(n,i)=>e("center",{children:i.send_to_collector?e(t,{id:"TableOfOrders.Send"}):e(t,{id:"TableOfOrders.DontSend"})})},{title:e(t,{id:"TableOfOrders.OrderStatus"}),dataIndex:"order_status",key:"order_status",render:n=>e("center",{children:e("span",{children:`${n}`})})},{title:e(t,{id:"TableOfOrders.NotificationStatus"}),dataIndex:"notification_status",key:"notification_status",render:n=>e("center",{children:e("span",{children:`${n}`})})},{title:e(t,{id:"TableOfOrders.AllowNotifications"}),dataIndex:"id",key:"actionAllowNotification",render:(n,i)=>e("center",{children:e(m,{type:"primary",onClick:()=>d.onSendLodNotification(i.id),children:i.notification_status!=="In progress"?e(t,{id:"TableOfOrders.Send"}):e(t,{id:"TableOfOrders.DontSend"})})})},{title:e(t,{id:"TableOfOrders.AllowSendToCollector"}),dataIndex:"id",key:"actionAllowSend",render:(n,i)=>e("center",{children:e(m,{type:"primary",onClick:()=>d.onSendLodCollector(i.id),children:i.send_to_collector?"Don't send":"Send"})})}],dataSource:d.data,size:"small",rowKey:()=>Math.random(),pagination:{position:"bottom",total:d.data.length,showTotal:(n,i)=>`${i[0]}-${i[1]} of ${n} items`,showSizeChanger:!0,pageSizeOptions:["10","20","50","100","200"],hideOnSinglePage:d.data.length<10},loading:d.loading})})}const V=z(y(H));function q(d){const[c,n]=f.useState(!1);return e(f.Fragment,{children:e(m,{disabled:d.data.length===0,loading:c,type:"primary",onClick:async()=>{n(!0);const i=await w(s.unix(d.start).format("DD-MM-YYYY"),s.unix(d.end).format("DD-MM-YYYY"),!0);if(i.status===200){const D=await i.blob();j.saveAs(D,"listofdebtors"),u.success({message:e(t,{id:"window.success"}),description:e(t,{id:"ListOfDebtors.Listofdebtors.xlsxSuccessfullyDownloaded!"})}),n(!1)}else u.error({message:e(t,{id:"window.error"}),description:i.statusText})},children:e(t,{id:"ListOfDebtors.DownloadXLSX"})})})}const G=y(q),{Option:l}=b,{RangePicker:J}=R;s.updateLocale("en",{week:{dow:1}});function Q(d){const[c,n]=f.useState([]),[i,D]=f.useState(-1),[h,p]=f.useState(-1),[x,S]=f.useState(!1),[v,_]=f.useState([]),[g,L]=f.useState(s().startOf("month").unix()),[T,M]=f.useState(s().endOf("month").unix()),k=r=>{try{D(r)}catch(a){console.log(a)}},C=r=>{try{p(r)}catch(a){console.log(a)}},A=async r=>{L(r[0].unix()),M(r[1].unix())},I=async r=>{const a=await B({id:r});a.status===200?(N(),u.success({message:"Success",description:"Permition Successfully Changed!"})):u.error({message:e(t,{id:"window.error"}),description:a.statusText})},P=async r=>{const a=await K({id:r});a.status===200?(N(),u.success({message:"Success",description:"Permission Successfully Changed!"})):u.error({message:e(t,{id:"window.error"}),description:a.statusText})},$=()=>v.filter(a=>!(c.includes("Sent to collector")&&!a.send_to_collector||c.includes("N 1")&&!a.notifications[0]||c.includes("N 2")&&!a.notifications[1]||c.includes("N 3")&&!a.notifications[2]||c.includes("N 4")&&!a.notifications[3]||h>-1&&(h===0&&a.notification_status!=="In progress"||h===1&&a.notification_status!=="Sending paused"||h===2&&a.notification_status!=="All sent")||i>-1&&(i===0&&a.order_status!=="Completed"||i===1&&a.order_status!=="Paused"||i===2&&a.order_status!=="Active"||i===3&&a.order_status!=="Not Accepted"||i===4&&a.order_status!=="All sent"))),N=()=>{S(!0),w(s.unix(g).format("DD-MM-YYYY"),s.unix(T).format("DD-MM-YYYY"),!1).then(async r=>{if(r.status===401){d({type:"user/SET_STATE",payload:{authorized:!1}});return}if(r.status===200){const a=await r.json();_(a.result),S(!1)}else u.error({message:r.status,description:r.statusText}),S(!1)})},Y=$();return o(E,{roles:["finance","root","salesDirector","readonlySearch"],redirect:!0,to:"/main",children:[e(F,{title:"List of debtors"}),o("div",{className:"row",children:[e("div",{className:"col-lg-4",children:o("div",{className:"card",children:[e("div",{className:"card-header",children:e("div",{className:"utils__title",children:e("strong",{children:e(t,{id:"ListOfDebtors.ListOfDebtors"})})})}),o("div",{style:{textAlign:"center"},className:"card-body",children:[e(J,{ranges:{"Previous Month":[s().subtract(1,"month").startOf("month"),s().subtract(1,"month").endOf("month")],"This Month":[s().startOf("month"),s().endOf("month")]},defaultValue:[s(g*1e3),s(T*1e3)],format:"DD.MM.YYYY",onChange:A}),e("br",{}),e(m,{loading:x,style:{marginTop:"10px"},type:"primary",onClick:N,size:"large",children:e(t,{id:"window.show"})})]})]})}),e("div",{className:"col-lg-8",children:e("div",{className:"card",children:o("div",{className:"card-body",children:[e("div",{className:"row",children:o("div",{className:"col-lg-12",children:[e("small",{children:e(t,{id:"ListOfDebtors.Notifications"})}),e("br",{}),e(b,{placeholder:e(t,{id:"ListOfDebtors.Notifications"}),mode:"tags",value:c,onChange:r=>n(r),style:{width:"100%"},children:["N 1","N 2","N 3","N 4","Sent to collector"].map(r=>e(l,{value:r,children:`${r}`},r))})]})}),o("div",{className:"row",children:[o("div",{className:"col-lg-2",children:[e("small",{children:e(t,{id:"ListOfDebtors.OrdersStatus"})}),e("br",{}),o(b,{value:i,style:{width:120},onChange:k,children:[e(l,{value:-1,children:e(t,{id:"ListOfDebtors.All"})}),e(l,{value:4,children:e(t,{id:"ListOfDebtors.AllSent"})}),e(l,{value:3,children:e(t,{id:"ListOfDebtors.NotAccepted"})}),e(l,{value:2,children:e(t,{id:"ListOfDebtors.Active"})}),e(l,{value:1,children:e(t,{id:"ListOfDebtors.Paused"})}),e(l,{value:0,children:e(t,{id:"ListOfDebtors.Complated"})})]})]}),o("div",{className:"col-lg-2",children:[e("small",{children:e(t,{id:"ListOfDebtors.NotificationStatus"})}),e("br",{}),o(b,{value:h,style:{width:120},onChange:C,children:[e(l,{value:-1,children:e(t,{id:"ListOfDebtors.All"})}),e(l,{value:2,children:e(t,{id:"ListOfDebtors.AllSent"})}),e(l,{value:1,children:e(t,{id:"ListOfDebtors.SendingPaused"})}),e(l,{value:0,children:e(t,{id:"ListOfDebtors.InProgress"})})]})]})]})]})})})]}),e("div",{className:"row",children:e("div",{className:"col-lg-12",children:e("div",{className:"card",children:o("div",{className:"card-body",children:[e(V,{data:Y,onSendLodNotification:I,onSendLodCollector:P,loading:x}),e("br",{}),e(G,{data:Y,start:g,end:T})]})})})})]})}const re=y(Q);export{re as default};
