var Vn=Object.defineProperty;var jn=(e,a,i)=>a in e?Vn(e,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[a]=i;var Q=(e,a,i)=>(jn(e,typeof a!="symbol"?a+"":a,i),i);import{a1 as De,a2 as Pe,c as D,j as u,a5 as yt,aa as y,bL as Zn,a4 as Gn,bF as qn,r as N,a as Me,B as qt,b as Kn,d2 as $n,d3 as Jn,d4 as Qn,a8 as dt,b4 as Ge,d5 as ta,d6 as ea,d7 as na,ci as aa,d8 as ia,d9 as sa,bq as oa}from"./index-c20b5e8e.js";import{R as Qt,C as U}from"./row-58ed805b.js";import"./PickerPanel-72c5d64a.js";/* empty css              */import{S as F,a as Kt}from"./index-297358d3.js";import{D as rn}from"./index-2f7554ca.js";import{S as ra}from"./index-ce7c4078.js";import{T as te}from"./Table-fe15f1b3.js";import"./Pagination-e2a53e90.js";import{f as ot,g as A,v as Jt,s as qe,C as la,b as ca,L as ua,P as da,c as ha,d as fa,p as ma,a as pa,e as ga}from"./index-c8879121.js";import{a as vt,b as va,c as ya,d as ve}from"./chartHelper-428a1cff.js";import{T as Sa}from"./index-8e340a60.js";import"./padStart-17be0050.js";import"./index-98f1088d.js";import"./styleChecker-a7b568e2.js";var Ke;const{Option:Nt}=yt;let Ta=De(Ke=class extends Pe.Component{constructor(){super(...arguments);Q(this,"state",{range:this.props.defaultRange||"today"});Q(this,"handleChangeRange",async i=>{this.setState({range:i.key})})}render(){const{defaultRange:i,data:r,intl:{formatMessage:o}}=this.props,{range:l}=this.state;return D("div",{className:"card",children:[u("div",{className:"card-header",children:u("div",{className:"utils__title",style:{marginBottom:"-20px"},children:D("strong",{className:"text-uppercase font-size-14",children:[D(yt,{labelInValue:!0,defaultValue:{key:i},style:{marginBottom:"15px",width:180,marginRight:"10px"},onChange:this.handleChangeRange,children:[u(Nt,{value:"today",children:o({id:"SalesStatsCardB2B.Today"})}),u(Nt,{value:"week",children:o({id:"SalesStatsCardB2B.CurrentWeek"})}),u(Nt,{value:"lastWeek",children:o({id:"SalesStatsCardB2B.LastWeek"})}),u(Nt,{value:"month",children:o({id:"SalesStatsCardB2B.CurrentMonth"})}),u(Nt,{value:"lastMonth",children:o({id:"SalesStatsCardB2B.LastMonth"})})]}),o({id:"SalesStatsCardB2B.B2B"})]})})}),u("div",{className:"card-body",children:D(Qt,{gutter:20,children:[u(U,{sm:8,md:4,children:u(F,{title:o({id:"SalesStatsCardB2B.Days"}),value:r[l].stats.days})}),u(U,{sm:8,md:4,children:u(F,{title:o({id:"SalesStatsCardB2B.Companies"}),value:r[l].stats.companies})}),u(U,{sm:8,md:4,children:u(F,{title:o({id:"SalesStatsCardB2B.TotalPrice"}),value:r[l].stats.price.total})}),u(U,{sm:8,md:8,children:u(F,{title:o({id:"SalesStatsCardB2B.Avgpricep/d"}),value:r[l].stats.price.avg})})]})})]})}})||Ke;var $e;const{Option:_t}=yt;let xa=De($e=class extends Pe.Component{constructor(){super(...arguments);Q(this,"state",{ranges:this.props.defaultRange||"month"});Q(this,"handleChangeRange",async i=>{this.setState({ranges:i.key})})}render(){const{defaultRange:i,data:r,intl:{formatMessage:o}}=this.props,{ranges:l}=this.state,d=[{title:o({id:"SalesDataByManager.Manager"}),dataIndex:"name",key:"username",render:f=>u("b",{children:f})},{title:o({id:"SalesDataByManager.Trial"}),dataIndex:"status",key:"trial",render:f=>u("span",{children:f.trial})},{title:o({id:"SalesDataByManager.New"}),dataIndex:"status",key:"new",render:f=>u("span",{children:f.new})},{title:o({id:"SalesDataByManager.Prolong"}),dataIndex:"status",key:"prolong",render:f=>u("span",{children:f.prolong})},{title:o({id:"SalesDataByManager.Renewal"}),dataIndex:"status",key:"renew",render:f=>u("span",{children:f.renew})},{title:o({id:"SalesDataByManager.2Meals"}),dataIndex:"mealsPerDay",key:"2mpd",render:f=>u("span",{children:f[2]})},{title:o({id:"SalesDataByManager.3Meals"}),dataIndex:"mealsPerDay",key:"3mpd",render:f=>u("span",{children:f[3]})},{title:o({id:"SalesDataByManager.5Meals"}),dataIndex:"mealsPerDay",key:"5mpd",render:f=>u("span",{children:f[5]})},{title:o({id:"SalesDataByManager.Total"}),dataIndex:"total",key:"total",render:f=>u("span",{children:f})},{title:o({id:"SalesDataByManager.Total%"}),dataIndex:"total",key:"total-pers",render:f=>u("span",{children:f?(f/r[l].all*100).toFixed(1):"0"})}];return D("div",{className:"card",children:[u("div",{className:"card-header",children:u("div",{className:"utils__title",style:{marginBottom:"-20px"},children:u("strong",{className:"text-uppercase font-size-14",children:D(yt,{labelInValue:!0,defaultValue:{key:i},style:{marginBottom:"15px",width:180,marginRight:"10px"},onChange:this.handleChangeRange,children:[u(_t,{value:"today",children:o({id:"SalesDataByManager.Today"})}),u(_t,{value:"week",children:o({id:"SalesDataByManager.CurrentWeek"})}),u(_t,{value:"lastWeek",children:o({id:"SalesDataByManager.LastWeek"})}),u(_t,{value:"month",children:o({id:"SalesDataByManager.CurrentMonth"})}),u(_t,{value:"lastMonth",children:o({id:"SalesDataByManager.LastMonth"})})]})})})}),u("div",{className:"card-body",children:u(te,{tableLayout:"auto",scroll:{x:"100%"},columns:d,dataSource:r[l].sales,onChange:this.handleTableChange,pagination:!1,loading:this.state.loading,rowKey:()=>Math.random()})})]})}})||$e;var Je;const{RangePicker:Ea}=rn;let ba=De(Je=class extends Pe.Component{constructor(){super(...arguments);Q(this,"state",{usesByCustomerVisible:!1,selectedRecord:void 0,start:y().startOf("month").unix(),end:y().endOf("month").unix()});Q(this,"handleChangePeriod",async i=>{this.setState({start:i[0].unix(),end:i[1].unix()}),this.props.getPromoStats(y(i[0].unix()*1e3).format("DD-MM-YYYY"),y(i[1].unix()*1e3).format("DD-MM-YYYY"))});Q(this,"showModal",i=>{this.setState({selectedRecord:i,usesByCustomerVisible:!0})});Q(this,"handleOk",()=>{this.setState({usesByCustomerVisible:!1})});Q(this,"handleCancel",()=>{this.setState({usesByCustomerVisible:!1})})}UNSAFE_componentWillMount(){const{start:i,end:r}=this.state;this.props.getPromoStats(i,r)}render(){const{data:i,intl:{formatMessage:r},promoStatsLoading:o}=this.props,{usesByCustomerVisible:l,selectedRecord:d,start:f,end:g}=this.state,v=[{title:r({id:"PromoStats.Code"}),dataIndex:"code",key:"code",render:(p,T)=>u(Zn,{onClick:P=>{this.showModal(T),P.preventDefault()},to:"#",children:u("b",{children:p})})},{title:r({id:"PromoStats.Owner"}),dataIndex:"owner",key:"owner",render:p=>p},{title:r({id:"PromoStats.Amount"}),dataIndex:"amount",key:"amount",render:(p,T)=>D("span",{children:[p,T.type==="fixedAmount"?"K훾":"%"]})},{title:r({id:"PromoStats.Users"}),dataIndex:"totalUses",key:"uses",render:p=>u("span",{children:p})},{title:r({id:"PromoStats.Discount"}),dataIndex:"totalDiscount",key:"totalDiscount",render:p=>u("span",{children:p})}];return D("div",{className:"card",children:[u("div",{className:"card-header",children:u("div",{className:"utils__title",style:{marginBottom:"-20px"},children:u("strong",{className:"text-uppercase font-size-14",children:u(Ea,{ranges:{"Previous Month":[y().subtract(1,"month").startOf("month"),y().subtract(1,"month").endOf("month")],"This Month":[y().startOf("month"),y().endOf("month")]},defaultValue:[y(f*1e3),y(g*1e3)],format:"DD.MM.YYYY",onChange:this.handleChangePeriod,style:{marginRight:"10px",width:"75%"}})})})}),i&&!o&&D("div",{style:{marginTop:"20px"},className:"card-body",children:[D(Qt,{gutter:16,children:[u(U,{span:8,children:u(F,{title:"Total",value:i.total})}),u(U,{span:8,children:u(F,{title:"Total uses",value:i.totalUses})}),u(U,{span:8,children:u(F,{title:"Total discount",value:i.totalDiscount})})]}),u(te,{tableLayout:"auto",scroll:{x:"100%"},columns:v,dataSource:i.codes,pagination:{position:"bottom",total:i.total,showTotal:(p,T)=>`${T[0]}-${T[1]} of ${p} items`,showSizeChanger:!0,pageSizeOptions:["10","20","50","100","200"],hideOnSinglePage:i.length<10},loading:this.state.loading,rowKey:()=>Math.random()}),u(Gn,{title:"Orders with promocode",open:l,onOk:this.handleOk,cancelButtonProps:{hidden:!0},onCancel:this.handleCancel,children:i&&i.length!==0&&d!==void 0&&d.usesByOrder.map(p=>D("p",{children:[u(qn,{to:`/orders/${p.id}`,target:"_blank",rel:"noopener noreferrer",children:p.name})," ","- ",p.discount," K훾"]},p.id))})]}),!i||o&&u("div",{className:"card-body",children:u(Kt,{})})]})}})||Je;var Se={},Da={get exports(){return Se},set exports(e){Se=e}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e){(function(a,i,r,o){var l=["","webkit","Moz","MS","ms","o"],d=i.createElement("div"),f="function",g=Math.round,v=Math.abs,p=Date.now;function T(t,n,s){return setTimeout(St(t,s),n)}function P(t,n,s){return Array.isArray(t)?(x(t,s[n],s),!0):!1}function x(t,n,s){var c;if(t)if(t.forEach)t.forEach(n,s);else if(t.length!==o)for(c=0;c<t.length;)n.call(s,t[c],c,t),c++;else for(c in t)t.hasOwnProperty(c)&&n.call(s,t[c],c,t)}function C(t,n,s){var c="DEPRECATED METHOD: "+n+`
`+s+` AT 
`;return function(){var h=new Error("get-stack-trace"),m=h&&h.stack?h.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",S=a.console&&(a.console.warn||a.console.log);return S&&S.call(a.console,c,m),t.apply(this,arguments)}}var O;typeof Object.assign!="function"?O=function(n){if(n===o||n===null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(n),c=1;c<arguments.length;c++){var h=arguments[c];if(h!==o&&h!==null)for(var m in h)h.hasOwnProperty(m)&&(s[m]=h[m])}return s}:O=Object.assign;var rt=C(function(n,s,c){for(var h=Object.keys(s),m=0;m<h.length;)(!c||c&&n[h[m]]===o)&&(n[h[m]]=s[h[m]]),m++;return n},"extend","Use `assign`."),ee=C(function(n,s){return rt(n,s,!0)},"merge","Use `assign`.");function k(t,n,s){var c=n.prototype,h;h=t.prototype=Object.create(c),h.constructor=t,h._super=c,s&&O(h,s)}function St(t,n){return function(){return t.apply(n,arguments)}}function Tt(t,n){return typeof t==f?t.apply(n&&n[0]||o,n):t}function ft(t,n){return t===o?n:t}function mt(t,n,s){x(H(n),function(c){t.addEventListener(c,s,!1)})}function lt(t,n,s){x(H(n),function(c){t.removeEventListener(c,s,!1)})}function kt(t,n){for(;t;){if(t==n)return!0;t=t.parentNode}return!1}function G(t,n){return t.indexOf(n)>-1}function H(t){return t.trim().split(/\s+/g)}function it(t,n,s){if(t.indexOf&&!s)return t.indexOf(n);for(var c=0;c<t.length;){if(s&&t[c][s]==n||!s&&t[c]===n)return c;c++}return-1}function W(t){return Array.prototype.slice.call(t,0)}function Rt(t,n,s){for(var c=[],h=[],m=0;m<t.length;){var S=n?t[m][n]:t[m];it(h,S)<0&&c.push(t[m]),h[m]=S,m++}return s&&(n?c=c.sort(function(Y,R){return Y[n]>R[n]}):c=c.sort()),c}function pt(t,n){for(var s,c,h=n[0].toUpperCase()+n.slice(1),m=0;m<l.length;){if(s=l[m],c=s?s+h:n,c in t)return c;m++}return o}var ne=1;function L(){return ne++}function q(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||a}var Lt=/mobile|tablet|ip(ad|hone|od)|android/i,zt="ontouchstart"in a,ae=pt(a,"PointerEvent")!==o,ie=zt&&Lt.test(navigator.userAgent),tt="touch",se="pen",xt="mouse",oe="kinect",b=25,E=1,_=2,M=4,z=8,Bt=1,Et=2,bt=4,Dt=8,Pt=16,K=Et|bt,ct=Dt|Pt,Ne=K|ct,_e=["x","y"],Ut=["clientX","clientY"];function X(t,n){var s=this;this.manager=t,this.callback=n,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(c){Tt(t.options.enable,[t])&&s.handler(c)},this.init()}X.prototype={handler:function(){},init:function(){this.evEl&&mt(this.element,this.evEl,this.domHandler),this.evTarget&&mt(this.target,this.evTarget,this.domHandler),this.evWin&&mt(q(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&lt(this.element,this.evEl,this.domHandler),this.evTarget&&lt(this.target,this.evTarget,this.domHandler),this.evWin&&lt(q(this.element),this.evWin,this.domHandler)}};function yn(t){var n,s=t.options.inputClass;return s?n=s:ae?n=le:ie?n=Wt:zt?n=ce:n=Ht,new n(t,Sn)}function Sn(t,n,s){var c=s.pointers.length,h=s.changedPointers.length,m=n&E&&c-h===0,S=n&(M|z)&&c-h===0;s.isFirst=!!m,s.isFinal=!!S,m&&(t.session={}),s.eventType=n,Tn(t,s),t.emit("hammer.input",s),t.recognize(s),t.session.prevInput=s}function Tn(t,n){var s=t.session,c=n.pointers,h=c.length;s.firstInput||(s.firstInput=Ie(n)),h>1&&!s.firstMultiple?s.firstMultiple=Ie(n):h===1&&(s.firstMultiple=!1);var m=s.firstInput,S=s.firstMultiple,w=S?S.center:m.center,Y=n.center=we(c);n.timeStamp=p(),n.deltaTime=n.timeStamp-m.timeStamp,n.angle=re(w,Y),n.distance=Ft(w,Y),xn(s,n),n.offsetDirection=Ae(n.deltaX,n.deltaY);var R=Ye(n.deltaTime,n.deltaX,n.deltaY);n.overallVelocityX=R.x,n.overallVelocityY=R.y,n.overallVelocity=v(R.x)>v(R.y)?R.x:R.y,n.scale=S?Dn(S.pointers,c):1,n.rotation=S?bn(S.pointers,c):0,n.maxPointers=s.prevInput?n.pointers.length>s.prevInput.maxPointers?n.pointers.length:s.prevInput.maxPointers:n.pointers.length,En(s,n);var J=t.element;kt(n.srcEvent.target,J)&&(J=n.srcEvent.target),n.target=J}function xn(t,n){var s=n.center,c=t.offsetDelta||{},h=t.prevDelta||{},m=t.prevInput||{};(n.eventType===E||m.eventType===M)&&(h=t.prevDelta={x:m.deltaX||0,y:m.deltaY||0},c=t.offsetDelta={x:s.x,y:s.y}),n.deltaX=h.x+(s.x-c.x),n.deltaY=h.y+(s.y-c.y)}function En(t,n){var s=t.lastInterval||n,c=n.timeStamp-s.timeStamp,h,m,S,w;if(n.eventType!=z&&(c>b||s.velocity===o)){var Y=n.deltaX-s.deltaX,R=n.deltaY-s.deltaY,J=Ye(c,Y,R);m=J.x,S=J.y,h=v(J.x)>v(J.y)?J.x:J.y,w=Ae(Y,R),t.lastInterval=n}else h=s.velocity,m=s.velocityX,S=s.velocityY,w=s.direction;n.velocity=h,n.velocityX=m,n.velocityY=S,n.direction=w}function Ie(t){for(var n=[],s=0;s<t.pointers.length;)n[s]={clientX:g(t.pointers[s].clientX),clientY:g(t.pointers[s].clientY)},s++;return{timeStamp:p(),pointers:n,center:we(n),deltaX:t.deltaX,deltaY:t.deltaY}}function we(t){var n=t.length;if(n===1)return{x:g(t[0].clientX),y:g(t[0].clientY)};for(var s=0,c=0,h=0;h<n;)s+=t[h].clientX,c+=t[h].clientY,h++;return{x:g(s/n),y:g(c/n)}}function Ye(t,n,s){return{x:n/t||0,y:s/t||0}}function Ae(t,n){return t===n?Bt:v(t)>=v(n)?t<0?Et:bt:n<0?Dt:Pt}function Ft(t,n,s){s||(s=_e);var c=n[s[0]]-t[s[0]],h=n[s[1]]-t[s[1]];return Math.sqrt(c*c+h*h)}function re(t,n,s){s||(s=_e);var c=n[s[0]]-t[s[0]],h=n[s[1]]-t[s[1]];return Math.atan2(h,c)*180/Math.PI}function bn(t,n){return re(n[1],n[0],Ut)+re(t[1],t[0],Ut)}function Dn(t,n){return Ft(n[0],n[1],Ut)/Ft(t[0],t[1],Ut)}var Pn={mousedown:E,mousemove:_,mouseup:M},Mn="mousedown",Cn="mousemove mouseup";function Ht(){this.evEl=Mn,this.evWin=Cn,this.pressed=!1,X.apply(this,arguments)}k(Ht,X,{handler:function(n){var s=Pn[n.type];s&E&&n.button===0&&(this.pressed=!0),s&_&&n.which!==1&&(s=M),this.pressed&&(s&M&&(this.pressed=!1),this.callback(this.manager,s,{pointers:[n],changedPointers:[n],pointerType:xt,srcEvent:n}))}});var On={pointerdown:E,pointermove:_,pointerup:M,pointercancel:z,pointerout:z},Nn={2:tt,3:se,4:xt,5:oe},ke="pointerdown",Re="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(ke="MSPointerDown",Re="MSPointerMove MSPointerUp MSPointerCancel");function le(){this.evEl=ke,this.evWin=Re,X.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}k(le,X,{handler:function(n){var s=this.store,c=!1,h=n.type.toLowerCase().replace("ms",""),m=On[h],S=Nn[n.pointerType]||n.pointerType,w=S==tt,Y=it(s,n.pointerId,"pointerId");m&E&&(n.button===0||w)?Y<0&&(s.push(n),Y=s.length-1):m&(M|z)&&(c=!0),!(Y<0)&&(s[Y]=n,this.callback(this.manager,m,{pointers:s,changedPointers:[n],pointerType:S,srcEvent:n}),c&&s.splice(Y,1))}});var _n={touchstart:E,touchmove:_,touchend:M,touchcancel:z},In="touchstart",wn="touchstart touchmove touchend touchcancel";function Le(){this.evTarget=In,this.evWin=wn,this.started=!1,X.apply(this,arguments)}k(Le,X,{handler:function(n){var s=_n[n.type];if(s===E&&(this.started=!0),!!this.started){var c=Yn.call(this,n,s);s&(M|z)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,s,{pointers:c[0],changedPointers:c[1],pointerType:tt,srcEvent:n})}}});function Yn(t,n){var s=W(t.touches),c=W(t.changedTouches);return n&(M|z)&&(s=Rt(s.concat(c),"identifier",!0)),[s,c]}var An={touchstart:E,touchmove:_,touchend:M,touchcancel:z},kn="touchstart touchmove touchend touchcancel";function Wt(){this.evTarget=kn,this.targetIds={},X.apply(this,arguments)}k(Wt,X,{handler:function(n){var s=An[n.type],c=Rn.call(this,n,s);c&&this.callback(this.manager,s,{pointers:c[0],changedPointers:c[1],pointerType:tt,srcEvent:n})}});function Rn(t,n){var s=W(t.touches),c=this.targetIds;if(n&(E|_)&&s.length===1)return c[s[0].identifier]=!0,[s,s];var h,m,S=W(t.changedTouches),w=[],Y=this.target;if(m=s.filter(function(R){return kt(R.target,Y)}),n===E)for(h=0;h<m.length;)c[m[h].identifier]=!0,h++;for(h=0;h<S.length;)c[S[h].identifier]&&w.push(S[h]),n&(M|z)&&delete c[S[h].identifier],h++;if(w.length)return[Rt(m.concat(w),"identifier",!0),w]}var Ln=2500,ze=25;function ce(){X.apply(this,arguments);var t=St(this.handler,this);this.touch=new Wt(this.manager,t),this.mouse=new Ht(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}k(ce,X,{handler:function(n,s,c){var h=c.pointerType==tt,m=c.pointerType==xt;if(!(m&&c.sourceCapabilities&&c.sourceCapabilities.firesTouchEvents)){if(h)zn.call(this,s,c);else if(m&&Bn.call(this,c))return;this.callback(n,s,c)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function zn(t,n){t&E?(this.primaryTouch=n.changedPointers[0].identifier,Be.call(this,n)):t&(M|z)&&Be.call(this,n)}function Be(t){var n=t.changedPointers[0];if(n.identifier===this.primaryTouch){var s={x:n.clientX,y:n.clientY};this.lastTouches.push(s);var c=this.lastTouches,h=function(){var m=c.indexOf(s);m>-1&&c.splice(m,1)};setTimeout(h,Ln)}}function Bn(t){for(var n=t.srcEvent.clientX,s=t.srcEvent.clientY,c=0;c<this.lastTouches.length;c++){var h=this.lastTouches[c],m=Math.abs(n-h.x),S=Math.abs(s-h.y);if(m<=ze&&S<=ze)return!0}return!1}var Ue=pt(d.style,"touchAction"),Fe=Ue!==o,He="compute",We="auto",ue="manipulation",ut="none",Mt="pan-x",Ct="pan-y",Xt=Fn();function de(t,n){this.manager=t,this.set(n)}de.prototype={set:function(t){t==He&&(t=this.compute()),Fe&&this.manager.element.style&&Xt[t]&&(this.manager.element.style[Ue]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return x(this.manager.recognizers,function(n){Tt(n.options.enable,[n])&&(t=t.concat(n.getTouchAction()))}),Un(t.join(" "))},preventDefaults:function(t){var n=t.srcEvent,s=t.offsetDirection;if(this.manager.session.prevented){n.preventDefault();return}var c=this.actions,h=G(c,ut)&&!Xt[ut],m=G(c,Ct)&&!Xt[Ct],S=G(c,Mt)&&!Xt[Mt];if(h){var w=t.pointers.length===1,Y=t.distance<2,R=t.deltaTime<250;if(w&&Y&&R)return}if(!(S&&m)&&(h||m&&s&K||S&&s&ct))return this.preventSrc(n)},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};function Un(t){if(G(t,ut))return ut;var n=G(t,Mt),s=G(t,Ct);return n&&s?ut:n||s?n?Mt:Ct:G(t,ue)?ue:We}function Fn(){if(!Fe)return!1;var t={},n=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(s){t[s]=n?a.CSS.supports("touch-action",s):!0}),t}var Vt=1,V=2,gt=4,st=8,et=st,Ot=16,$=32;function nt(t){this.options=O({},this.defaults,t||{}),this.id=L(),this.manager=null,this.options.enable=ft(this.options.enable,!0),this.state=Vt,this.simultaneous={},this.requireFail=[]}nt.prototype={defaults:{},set:function(t){return O(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(P(t,"recognizeWith",this))return this;var n=this.simultaneous;return t=jt(t,this),n[t.id]||(n[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return P(t,"dropRecognizeWith",this)?this:(t=jt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(P(t,"requireFailure",this))return this;var n=this.requireFail;return t=jt(t,this),it(n,t)===-1&&(n.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(P(t,"dropRequireFailure",this))return this;t=jt(t,this);var n=it(this.requireFail,t);return n>-1&&this.requireFail.splice(n,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var n=this,s=this.state;function c(h){n.manager.emit(h,t)}s<st&&c(n.options.event+Xe(s)),c(n.options.event),t.additionalEvent&&c(t.additionalEvent),s>=st&&c(n.options.event+Xe(s))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=$},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&($|Vt)))return!1;t++}return!0},recognize:function(t){var n=O({},t);if(!Tt(this.options.enable,[this,n])){this.reset(),this.state=$;return}this.state&(et|Ot|$)&&(this.state=Vt),this.state=this.process(n),this.state&(V|gt|st|Ot)&&this.tryEmit(n)},process:function(t){},getTouchAction:function(){},reset:function(){}};function Xe(t){return t&Ot?"cancel":t&st?"end":t&gt?"move":t&V?"start":""}function Ve(t){return t==Pt?"down":t==Dt?"up":t==Et?"left":t==bt?"right":""}function jt(t,n){var s=n.manager;return s?s.get(t):t}function j(){nt.apply(this,arguments)}k(j,nt,{defaults:{pointers:1},attrTest:function(t){var n=this.options.pointers;return n===0||t.pointers.length===n},process:function(t){var n=this.state,s=t.eventType,c=n&(V|gt),h=this.attrTest(t);return c&&(s&z||!h)?n|Ot:c||h?s&M?n|st:n&V?n|gt:V:$}});function Zt(){j.apply(this,arguments),this.pX=null,this.pY=null}k(Zt,j,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ne},getTouchAction:function(){var t=this.options.direction,n=[];return t&K&&n.push(Ct),t&ct&&n.push(Mt),n},directionTest:function(t){var n=this.options,s=!0,c=t.distance,h=t.direction,m=t.deltaX,S=t.deltaY;return h&n.direction||(n.direction&K?(h=m===0?Bt:m<0?Et:bt,s=m!=this.pX,c=Math.abs(t.deltaX)):(h=S===0?Bt:S<0?Dt:Pt,s=S!=this.pY,c=Math.abs(t.deltaY))),t.direction=h,s&&c>n.threshold&&h&n.direction},attrTest:function(t){return j.prototype.attrTest.call(this,t)&&(this.state&V||!(this.state&V)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var n=Ve(t.direction);n&&(t.additionalEvent=this.options.event+n),this._super.emit.call(this,t)}});function he(){j.apply(this,arguments)}k(he,j,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ut]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&V)},emit:function(t){if(t.scale!==1){var n=t.scale<1?"in":"out";t.additionalEvent=this.options.event+n}this._super.emit.call(this,t)}});function fe(){nt.apply(this,arguments),this._timer=null,this._input=null}k(fe,nt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[We]},process:function(t){var n=this.options,s=t.pointers.length===n.pointers,c=t.distance<n.threshold,h=t.deltaTime>n.time;if(this._input=t,!c||!s||t.eventType&(M|z)&&!h)this.reset();else if(t.eventType&E)this.reset(),this._timer=T(function(){this.state=et,this.tryEmit()},n.time,this);else if(t.eventType&M)return et;return $},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===et&&(t&&t.eventType&M?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function me(){j.apply(this,arguments)}k(me,j,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ut]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&V)}});function pe(){j.apply(this,arguments)}k(pe,j,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:K|ct,pointers:1},getTouchAction:function(){return Zt.prototype.getTouchAction.call(this)},attrTest:function(t){var n=this.options.direction,s;return n&(K|ct)?s=t.overallVelocity:n&K?s=t.overallVelocityX:n&ct&&(s=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&v(s)>this.options.velocity&&t.eventType&M},emit:function(t){var n=Ve(t.offsetDirection);n&&this.manager.emit(this.options.event+n,t),this.manager.emit(this.options.event,t)}});function Gt(){nt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}k(Gt,nt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ue]},process:function(t){var n=this.options,s=t.pointers.length===n.pointers,c=t.distance<n.threshold,h=t.deltaTime<n.time;if(this.reset(),t.eventType&E&&this.count===0)return this.failTimeout();if(c&&h&&s){if(t.eventType!=M)return this.failTimeout();var m=this.pTime?t.timeStamp-this.pTime<n.interval:!0,S=!this.pCenter||Ft(this.pCenter,t.center)<n.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,!S||!m?this.count=1:this.count+=1,this._input=t;var w=this.count%n.taps;if(w===0)return this.hasRequireFailures()?(this._timer=T(function(){this.state=et,this.tryEmit()},n.interval,this),V):et}return $},failTimeout:function(){return this._timer=T(function(){this.state=$},this.options.interval,this),$},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==et&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function at(t,n){return n=n||{},n.recognizers=ft(n.recognizers,at.defaults.preset),new ge(t,n)}at.VERSION="2.0.7",at.defaults={domEvents:!1,touchAction:He,enable:!0,inputTarget:null,inputClass:null,preset:[[me,{enable:!1}],[he,{enable:!1},["rotate"]],[pe,{direction:K}],[Zt,{direction:K},["swipe"]],[Gt],[Gt,{event:"doubletap",taps:2},["tap"]],[fe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Hn=1,je=2;function ge(t,n){this.options=O({},at.defaults,n||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=yn(this),this.touchAction=new de(this,this.options.touchAction),Ze(this,!0),x(this.options.recognizers,function(s){var c=this.add(new s[0](s[1]));s[2]&&c.recognizeWith(s[2]),s[3]&&c.requireFailure(s[3])},this)}ge.prototype={set:function(t){return O(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?je:Hn},recognize:function(t){var n=this.session;if(!n.stopped){this.touchAction.preventDefaults(t);var s,c=this.recognizers,h=n.curRecognizer;(!h||h&&h.state&et)&&(h=n.curRecognizer=null);for(var m=0;m<c.length;)s=c[m],n.stopped!==je&&(!h||s==h||s.canRecognizeWith(h))?s.recognize(t):s.reset(),!h&&s.state&(V|gt|st)&&(h=n.curRecognizer=s),m++}},get:function(t){if(t instanceof nt)return t;for(var n=this.recognizers,s=0;s<n.length;s++)if(n[s].options.event==t)return n[s];return null},add:function(t){if(P(t,"add",this))return this;var n=this.get(t.options.event);return n&&this.remove(n),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(P(t,"remove",this))return this;if(t=this.get(t),t){var n=this.recognizers,s=it(n,t);s!==-1&&(n.splice(s,1),this.touchAction.update())}return this},on:function(t,n){if(t!==o&&n!==o){var s=this.handlers;return x(H(t),function(c){s[c]=s[c]||[],s[c].push(n)}),this}},off:function(t,n){if(t!==o){var s=this.handlers;return x(H(t),function(c){n?s[c]&&s[c].splice(it(s[c],n),1):delete s[c]}),this}},emit:function(t,n){this.options.domEvents&&Wn(t,n);var s=this.handlers[t]&&this.handlers[t].slice();if(!(!s||!s.length)){n.type=t,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var c=0;c<s.length;)s[c](n),c++}},destroy:function(){this.element&&Ze(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ze(t,n){var s=t.element;if(s.style){var c;x(t.options.cssProps,function(h,m){c=pt(s.style,m),n?(t.oldCssProps[c]=s.style[c],s.style[c]=h):s.style[c]=t.oldCssProps[c]||""}),n||(t.oldCssProps={})}}function Wn(t,n){var s=i.createEvent("Event");s.initEvent(t,!0,!0),s.gesture=n,n.target.dispatchEvent(s)}O(at,{INPUT_START:E,INPUT_MOVE:_,INPUT_END:M,INPUT_CANCEL:z,STATE_POSSIBLE:Vt,STATE_BEGAN:V,STATE_CHANGED:gt,STATE_ENDED:st,STATE_RECOGNIZED:et,STATE_CANCELLED:Ot,STATE_FAILED:$,DIRECTION_NONE:Bt,DIRECTION_LEFT:Et,DIRECTION_RIGHT:bt,DIRECTION_UP:Dt,DIRECTION_DOWN:Pt,DIRECTION_HORIZONTAL:K,DIRECTION_VERTICAL:ct,DIRECTION_ALL:Ne,Manager:ge,Input:X,TouchAction:de,TouchInput:Wt,MouseInput:Ht,PointerEventInput:le,TouchMouseInput:ce,SingleTouchInput:Le,Recognizer:nt,AttrRecognizer:j,Tap:Gt,Pan:Zt,Swipe:pe,Pinch:he,Rotate:me,Press:fe,on:mt,off:lt,each:x,merge:ee,extend:rt,assign:O,inherit:k,bindFn:St,prefixed:pt});var Xn=typeof a<"u"?a:typeof self<"u"?self:{};Xn.Hammer=at,typeof o=="function"&&o.amd?o(function(){return at}):e.exports?e.exports=at:a[r]=at})(window,document,"Hammer")})(Da);const wt=Se;/*!
* chartjs-plugin-zoom v1.2.1
* undefined
 * (c) 2016-2022 chartjs-plugin-zoom Contributors
 * Released under the MIT License
 */const Yt=e=>e&&e.enabled&&e.modifierKey,ln=(e,a)=>e&&a[e+"Key"],Ce=(e,a)=>e&&!a[e+"Key"];function B(e,a,i){return e===void 0?!0:typeof e=="string"?e.indexOf(a)!==-1:typeof e=="function"?e({chart:i}).indexOf(a)!==-1:!1}function Pa(e,a){let i;return function(){return clearTimeout(i),i=setTimeout(e,a),a}}function Ma({x:e,y:a},i){const r=i.scales,o=Object.keys(r);for(let l=0;l<o.length;l++){const d=r[o[l]];if(a>=d.top&&a<=d.bottom&&e>=d.left&&e<=d.right)return d}return null}function cn(e,a,i){const r=Ma(a,i);if(r&&B(e,r.axis,i))return[r];const o=[];return ot(i.scales,function(l){B(e,l.axis,i)||o.push(l)}),o}const Te=new WeakMap;function I(e){let a=Te.get(e);return a||(a={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{}},Te.set(e,a)),a}function Ca(e){Te.delete(e)}function un(e,a,i){const r=e.max-e.min,o=r*(a-1),l=e.isHorizontal()?i.x:i.y,d=Math.max(0,Math.min(1,(e.getValueForPixel(l)-e.min)/r||0)),f=1-d;return{min:o*d,max:o*f}}function Qe(e,a,i,r,o){let l=i[r];if(l==="original"){const d=e.originalScaleLimits[a.id][r];l=Jt(d.options,d.scale)}return Jt(l,o)}function ht(e,{min:a,max:i},r,o=!1){const l=I(e.chart),{id:d,axis:f,options:g}=e,v=r&&(r[d]||r[f])||{},{minRange:p=0}=v,T=Qe(l,e,v,"min",-1/0),P=Qe(l,e,v,"max",1/0),x=Math.max(a,T),C=Math.min(i,P),O=o?Math.max(C-x,p):e.max-e.min;if(C-x!==O)if(T>C-O)a=x,i=x+O;else if(P<x+O)i=C,a=C-O;else{const rt=(O-C+x)/2;a=x-rt,i=C+rt}else a=x,i=C;return g.min=a,g.max=i,l.updatedScaleLimits[e.id]={min:a,max:i},e.parse(a)!==e.min||e.parse(i)!==e.max}function Oa(e,a,i,r){const o=un(e,a,i),l={min:e.min+o.min,max:e.max-o.max};return ht(e,l,r,!0)}const tn=e=>e===0||isNaN(e)?0:e<0?Math.min(Math.round(e),-1):Math.max(Math.round(e),1);function Na(e){const i=e.getLabels().length-1;e.min>0&&(e.min-=1),e.max<i&&(e.max+=1)}function _a(e,a,i,r){const o=un(e,a,i);e.min===e.max&&a<1&&Na(e);const l={min:e.min+tn(o.min),max:e.max-tn(o.max)};return ht(e,l,r,!0)}function Ia(e){return e.isHorizontal()?e.width:e.height}function wa(e,a,i){const o=e.getLabels().length-1;let{min:l,max:d}=e;const f=Math.max(d-l,1),g=Math.round(Ia(e)/Math.max(f,10)),v=Math.round(Math.abs(a/g));let p;return a<-g?(d=Math.min(d+v,o),l=f===1?d:d-f,p=d===o):a>g&&(l=Math.max(0,l-v),d=f===1?l:l+f,p=l===0),ht(e,{min:l,max:d},i)||p}const Ya={second:500,minute:30*1e3,hour:30*60*1e3,day:12*60*60*1e3,week:3.5*24*60*60*1e3,month:15*24*60*60*1e3,quarter:60*24*60*60*1e3,year:182*24*60*60*1e3};function dn(e,a,i,r=!1){const{min:o,max:l,options:d}=e,f=d.time&&d.time.round,g=Ya[f]||0,v=e.getValueForPixel(e.getPixelForValue(o+g)-a),p=e.getValueForPixel(e.getPixelForValue(l+g)-a),{min:T=-1/0,max:P=1/0}=r&&i&&i[e.axis]||{};return isNaN(v)||isNaN(p)||v<T||p>P?!0:ht(e,{min:v,max:p},i,r)}function en(e,a,i){return dn(e,a,i,!0)}const xe={category:_a,default:Oa},Ee={category:wa,default:dn,logarithmic:en,timeseries:en};function Aa(e,a,i){const{id:r,options:{min:o,max:l}}=e;if(!a[r]||!i[r])return!0;const d=i[r];return d.min!==o||d.max!==l}function nn(e,a){ot(e,(i,r)=>{a[r]||delete e[r]})}function At(e,a){const{scales:i}=e,{originalScaleLimits:r,updatedScaleLimits:o}=a;return ot(i,function(l){Aa(l,r,o)&&(r[l.id]={min:{scale:l.min,options:l.options.min},max:{scale:l.max,options:l.options.max}})}),nn(r,i),nn(o,i),r}function an(e,a,i,r){const o=xe[e.type]||xe.default;A(o,[e,a,i,r])}function ka(e){const a=e.chartArea;return{x:(a.left+a.right)/2,y:(a.top+a.bottom)/2}}function Oe(e,a,i="none"){const{x:r=1,y:o=1,focalPoint:l=ka(e)}=typeof a=="number"?{x:a,y:a}:a,d=I(e),{options:{limits:f,zoom:g}}=d,{mode:v="xy",overScaleMode:p}=g||{};At(e,d);const T=r!==1&&B(v,"x",e),P=o!==1&&B(v,"y",e),x=p&&cn(p,l,e);ot(x||e.scales,function(C){C.isHorizontal()&&T?an(C,r,l,f):!C.isHorizontal()&&P&&an(C,o,l,f)}),e.update(i),A(g.onZoom,[{chart:e}])}function sn(e,a,i){const r=e.getValueForPixel(a),o=e.getValueForPixel(i);return{min:Math.min(r,o),max:Math.max(r,o)}}function Ra(e,a,i,r="none"){const o=I(e),{options:{limits:l,zoom:d}}=o,{mode:f="xy"}=d;At(e,o);const g=B(f,"x",e),v=B(f,"y",e);ot(e.scales,function(p){p.isHorizontal()&&g?ht(p,sn(p,a.x,i.x),l,!0):!p.isHorizontal()&&v&&ht(p,sn(p,a.y,i.y),l,!0)}),e.update(r),A(d.onZoom,[{chart:e}])}function La(e,a,i,r="none"){At(e,I(e));const o=e.scales[a];ht(o,i,void 0,!0),e.update(r)}function za(e,a="default"){const i=I(e),r=At(e,i);ot(e.scales,function(o){const l=o.options;r[o.id]?(l.min=r[o.id].min.options,l.max=r[o.id].max.options):(delete l.min,delete l.max)}),e.update(a),A(i.options.zoom.onZoomComplete,[{chart:e}])}function Ba(e,a){const i=e.originalScaleLimits[a];if(!i)return;const{min:r,max:o}=i;return Jt(o.options,o.scale)-Jt(r.options,r.scale)}function Ua(e){const a=I(e);let i=1,r=1;return ot(e.scales,function(o){const l=Ba(a,o.id);if(l){const d=Math.round(l/(o.max-o.min)*100)/100;i=Math.min(i,d),r=Math.max(r,d)}}),i<1?i:r}function on(e,a,i,r){const{panDelta:o}=r,l=o[e.id]||0;qe(l)===qe(a)&&(a+=l);const d=Ee[e.type]||Ee.default;A(d,[e,a,i])?o[e.id]=0:o[e.id]=a}function hn(e,a,i,r="none"){const{x:o=0,y:l=0}=typeof a=="number"?{x:a,y:a}:a,d=I(e),{options:{pan:f,limits:g}}=d,{mode:v="xy",onPan:p}=f||{};At(e,d);const T=o!==0&&B(v,"x",e),P=l!==0&&B(v,"y",e);ot(i||e.scales,function(x){x.isHorizontal()&&T?on(x,o,g,d):!x.isHorizontal()&&P&&on(x,l,g,d)}),e.update(r),A(p,[{chart:e}])}function fn(e){const a=I(e),i={};for(const r of Object.keys(e.scales)){const{min:o,max:l}=a.originalScaleLimits[r]||{min:{},max:{}};i[r]={min:o.scale,max:l.scale}}return i}function Fa(e){const a=fn(e);for(const i of Object.keys(e.scales)){const{min:r,max:o}=a[i];if(r!==void 0&&e.scales[i].min!==r||o!==void 0&&e.scales[i].max!==o)return!0}return!1}function Z(e,a){const{handlers:i}=I(e),r=i[a];r&&r.target&&(r.target.removeEventListener(a,r),delete i[a])}function $t(e,a,i,r){const{handlers:o,options:l}=I(e),d=o[i];d&&d.target===a||(Z(e,i),o[i]=f=>r(e,f,l),o[i].target=a,a.addEventListener(i,o[i]))}function Ha(e,a){const i=I(e);i.dragStart&&(i.dragging=!0,i.dragEnd=a,e.update("none"))}function mn(e,a,i){const{onZoomStart:r,onZoomRejected:o}=i;if(r){const{left:l,top:d}=a.target.getBoundingClientRect(),f={x:a.clientX-l,y:a.clientY-d};if(A(r,[{chart:e,event:a,point:f}])===!1)return A(o,[{chart:e,event:a}]),!1}}function Wa(e,a){const i=I(e),{pan:r,zoom:o={}}=i.options;if(ln(Yt(r),a)||Ce(Yt(o.drag),a))return A(o.onZoomRejected,[{chart:e,event:a}]);mn(e,a,o)!==!1&&(i.dragStart=a,$t(e,e.canvas,"mousemove",Ha))}function pn(e,a,i,r){const{left:o,top:l}=i.target.getBoundingClientRect(),d=B(a,"x",e),f=B(a,"y",e);let{top:g,left:v,right:p,bottom:T,width:P,height:x}=e.chartArea;d&&(v=Math.min(i.clientX,r.clientX)-o,p=Math.max(i.clientX,r.clientX)-o),f&&(g=Math.min(i.clientY,r.clientY)-l,T=Math.max(i.clientY,r.clientY)-l);const C=p-v,O=T-g;return{left:v,top:g,right:p,bottom:T,width:C,height:O,zoomX:d&&C?1+(P-C)/P:1,zoomY:f&&O?1+(x-O)/x:1}}function Xa(e,a){const i=I(e);if(!i.dragStart)return;Z(e,"mousemove");const{mode:r,onZoomComplete:o,drag:{threshold:l=0}}=i.options.zoom,d=pn(e,r,i.dragStart,a),f=B(r,"x",e)?d.width:0,g=B(r,"y",e)?d.height:0,v=Math.sqrt(f*f+g*g);if(i.dragStart=i.dragEnd=null,v<=l){i.dragging=!1,e.update("none");return}Ra(e,{x:d.left,y:d.top},{x:d.right,y:d.bottom},"zoom"),setTimeout(()=>i.dragging=!1,500),A(o,[{chart:e}])}function Va(e,a,i){if(Ce(Yt(i.wheel),a)){A(i.onZoomRejected,[{chart:e,event:a}]);return}if(mn(e,a,i)!==!1&&(a.cancelable&&a.preventDefault(),a.deltaY!==void 0))return!0}function ja(e,a){const{handlers:{onZoomComplete:i},options:{zoom:r}}=I(e);if(!Va(e,a,r))return;const o=a.target.getBoundingClientRect(),l=1+(a.deltaY>=0?-r.wheel.speed:r.wheel.speed),d={x:l,y:l,focalPoint:{x:a.clientX-o.left,y:a.clientY-o.top}};Oe(e,d),i&&i()}function Za(e,a,i,r){i&&(I(e).handlers[a]=Pa(()=>A(i,[{chart:e}]),r))}function Ga(e,a){const i=e.canvas,{wheel:r,drag:o,onZoomComplete:l}=a.zoom;r.enabled?($t(e,i,"wheel",ja),Za(e,"onZoomComplete",l,250)):Z(e,"wheel"),o.enabled?($t(e,i,"mousedown",Wa),$t(e,i.ownerDocument,"mouseup",Xa)):(Z(e,"mousedown"),Z(e,"mousemove"),Z(e,"mouseup"))}function qa(e){Z(e,"mousedown"),Z(e,"mousemove"),Z(e,"mouseup"),Z(e,"wheel"),Z(e,"click")}function Ka(e,a){return function(i,r){const{pan:o,zoom:l={}}=a.options;if(!o||!o.enabled)return!1;const d=r&&r.srcEvent;return d&&!a.panning&&r.pointerType==="mouse"&&(Ce(Yt(o),d)||ln(Yt(l.drag),d))?(A(o.onPanRejected,[{chart:e,event:r}]),!1):!0}}function $a(e,a){const i=Math.abs(e.clientX-a.clientX),r=Math.abs(e.clientY-a.clientY),o=i/r;let l,d;return o>.3&&o<1.7?l=d=!0:i>r?l=!0:d=!0,{x:l,y:d}}function gn(e,a,i){if(a.scale){const{center:r,pointers:o}=i,l=1/a.scale*i.scale,d=i.target.getBoundingClientRect(),f=$a(o[0],o[1]),g=a.options.zoom.mode,v={x:f.x&&B(g,"x",e)?l:1,y:f.y&&B(g,"y",e)?l:1,focalPoint:{x:r.x-d.left,y:r.y-d.top}};Oe(e,v),a.scale=i.scale}}function Ja(e,a){a.options.zoom.pinch.enabled&&(a.scale=1)}function Qa(e,a,i){a.scale&&(gn(e,a,i),a.scale=null,A(a.options.zoom.onZoomComplete,[{chart:e}]))}function vn(e,a,i){const r=a.delta;r&&(a.panning=!0,hn(e,{x:i.deltaX-r.x,y:i.deltaY-r.y},a.panScales),a.delta={x:i.deltaX,y:i.deltaY})}function ti(e,a,i){const{enabled:r,overScaleMode:o,onPanStart:l,onPanRejected:d}=a.options.pan;if(!r)return;const f=i.target.getBoundingClientRect(),g={x:i.center.x-f.left,y:i.center.y-f.top};if(A(l,[{chart:e,event:i,point:g}])===!1)return A(d,[{chart:e,event:i}]);a.panScales=o&&cn(o,g,e),a.delta={x:0,y:0},clearTimeout(a.panEndTimeout),vn(e,a,i)}function ei(e,a){a.delta=null,a.panning&&(a.panEndTimeout=setTimeout(()=>a.panning=!1,500),A(a.options.pan.onPanComplete,[{chart:e}]))}const be=new WeakMap;function ni(e,a){const i=I(e),r=e.canvas,{pan:o,zoom:l}=a,d=new wt.Manager(r);l&&l.pinch.enabled&&(d.add(new wt.Pinch),d.on("pinchstart",()=>Ja(e,i)),d.on("pinch",f=>gn(e,i,f)),d.on("pinchend",f=>Qa(e,i,f))),o&&o.enabled&&(d.add(new wt.Pan({threshold:o.threshold,enable:Ka(e,i)})),d.on("panstart",f=>ti(e,i,f)),d.on("panmove",f=>vn(e,i,f)),d.on("panend",()=>ei(e,i))),be.set(e,d)}function ai(e){const a=be.get(e);a&&(a.remove("pinchstart"),a.remove("pinch"),a.remove("pinchend"),a.remove("panstart"),a.remove("pan"),a.remove("panend"),a.destroy(),be.delete(e))}var ii="1.2.1",si={id:"zoom",version:ii,defaults:{pan:{enabled:!1,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:!1,speed:.1,modifierKey:null},drag:{enabled:!1,modifierKey:null},pinch:{enabled:!1},mode:"xy"}},start:function(e,a,i){const r=I(e);r.options=i,Object.prototype.hasOwnProperty.call(i.zoom,"enabled")&&console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`."),wt&&ni(e,i),e.pan=(o,l,d)=>hn(e,o,l,d),e.zoom=(o,l)=>Oe(e,o,l),e.zoomScale=(o,l,d)=>La(e,o,l,d),e.resetZoom=o=>za(e,o),e.getZoomLevel=()=>Ua(e),e.getInitialScaleBounds=()=>fn(e),e.isZoomedOrPanned=()=>Fa(e)},beforeEvent(e){const a=I(e);if(a.panning||a.dragging)return!1},beforeUpdate:function(e,a,i){const r=I(e);r.options=i,Ga(e,i)},beforeDatasetsDraw:function(e,a,i){const{dragStart:r,dragEnd:o}=I(e);if(o){const{left:l,top:d,width:f,height:g}=pn(e,i.zoom.mode,r,o),v=i.zoom.drag,p=e.ctx;p.save(),p.beginPath(),p.fillStyle=v.backgroundColor||"rgba(225,225,225,0.3)",p.fillRect(l,d,f,g),v.borderWidth>0&&(p.lineWidth=v.borderWidth,p.strokeStyle=v.borderColor||"rgba(225,225,225)",p.strokeRect(l,d,f,g)),p.restore()}},stop:function(e){qa(e),wt&&ai(e),Ca(e)},panFunctions:Ee,zoomFunctions:xe};const{Option:It}=yt;la.register(ca,ua,da,ha,fa,ma,pa,si);const oi=({defaultType:e,months:a,loadGlobalChart:i,chartLoading:r})=>{const[,o]=N.useState(""),[l,d]=N.useState([]),{formatMessage:f}=Me(),g=T=>{if(o(T.key),T.key==="combined"){const P=Object.keys(ve).map(x=>({label:ve[x],data:a.map(C=>C[x]),borderColor:vt[x],backgroundColor:vt[x]}));d(P)}else d([{label:ve[T.key],data:a.map(P=>P[T.key]),borderColor:vt[T.key],backgroundColor:vt[T.key]}])},p={labels:a.map(({month:T})=>T),datasets:l};return N.useEffect(()=>{o(e),d([{label:e[0].toUpperCase()+e.slice(1),data:a.map(T=>T[e]),borderColor:vt[e],backgroundColor:vt[e]}])},[]),D("div",{className:"card",children:[u("div",{className:"card-header",children:D("div",{className:"utils__title",style:{marginBottom:"-20px"},children:[u("strong",{className:"text-uppercase font-size-14",children:D(yt,{labelInValue:!0,defaultValue:{key:e},style:{marginBottom:"15px",width:180,marginRight:"10px"},onChange:g,children:[u(It,{value:"all",children:f({id:"GlobalChartZoom.AllOrders"})}),u(It,{value:"new",children:f({id:"GlobalChartZoom.NewOrders"})}),u(It,{value:"prolong",children:f({id:"GlobalChartZoom.ProlongedOrders"})}),u(It,{value:"renew",children:f({id:"GlobalChartZoom.RenewalOrders"})}),u(It,{value:"combined",children:f({id:"GlobalChartZoom.Combined"})})]})}),u(qt,{loading:r,type:"primary",onClick:()=>i(),children:f({id:"GlobalChartZoom.LoadChart"})})]})}),u("div",{className:"card-body",children:u(ga,{data:p,options:va,plugins:ya})})]})},ri=({data:e,details:a})=>{const{formatMessage:i}=Me(),r={week:i({id:"SalesData.1week"}),twoWeek:i({id:"SalesData.2weeks"}),month:i({id:"SalesData.1month"}),twoMonth:i({id:"SalesData.2months"}),threeMonth:i({id:"SalesData.3months"}),total:i({id:"SalesData.mealsPerDay"})},o=[{title:i({id:"SalesData.Product"}),dataIndex:"title",key:"title",render:(l,d)=>u("span",{style:r[l]==="meals per day"?{fontWeight:"bold"}:{},children:`${r[l]===i({id:"SalesData.mealsPerDay"})?d.mealsPerDay:""} ${r[l]}`})},{title:i({id:"SalesData.New"}),dataIndex:"new",key:"new",render:l=>l},{title:i({id:"SalesData.Prolong"}),dataIndex:"prolong",key:"prolong",render:l=>u("span",{children:`${l}`})},{title:i({id:"SalesData.Renew"}),dataIndex:"renew",key:"renew",render:l=>u("span",{children:`${l}`}),sorter:(l,d)=>l.factMeals-d.factMeals},{title:i({id:"SalesData.Total"}),dataIndex:"total",key:"total",render:l=>u("span",{children:`${l}`})},{title:i({id:"SalesData.AveragePrice"}),dataIndex:"average",key:"average",render:l=>u("span",{children:l})},{title:i({id:"SalesData.TotalPrice"}),dataIndex:"totalPrice",key:"totalPrice",render:l=>l?u(Sa,{color:"green",children:l},"33434de3fe"):u("span",{children:l}),sorter:(l,d)=>l.totalPrice-d.totalPrice}];return D("div",{children:[a.total&&D(Qt,{children:[u(U,{sm:24,lg:4,children:u(F,{title:i({id:"SalesData.Orders(total)"}),value:a.total.count})}),u(U,{sm:24,lg:4,children:u(F,{title:i({id:"SalesData.New"}),value:a.total.new})}),u(U,{sm:24,lg:4,children:u(F,{title:i({id:"SalesData.Prolong"}),value:a.total.prolong})}),u(U,{sm:24,lg:4,children:u(F,{title:i({id:"SalesData.Renew"}),value:a.total.renew})}),u(U,{sm:24,lg:4,children:u(F,{title:i({id:"SalesData.TotalPrice"}),value:a.total.totalPrice,suffix:"K훾"})}),u(U,{sm:24,lg:4,children:u(F,{title:i({id:"SalesData.AveragePrice"}),value:Math.round(a.total.totalPrice/a.total.count),suffix:"K훾"})})]}),u(te,{className:"utils__scrollTable",tableLayout:"auto",scroll:{x:"100%"},columns:o,dataSource:e,pagination:{position:"bottom",total:e.length,showTotal:(l,d)=>`${d[0]}-${d[1]} of ${l} items`,showSizeChanger:!0,pageSizeOptions:["10","20","50","100","200"],hideOnSinglePage:e.length<10},rowKey:()=>Math.random()})]})},li=({data:e})=>{const[a,i]=N.useState([]),[r,o]=N.useState([]);return N.useEffect(()=>{e!=null&&e.columns&&i(e.columns.map(l=>({title:l,dataIndex:l}))),e!=null&&e.rows&&o(e.rows.map(({values:l},d)=>{const f={};return e.columns.forEach((g,v)=>{d===0&&v===0?f[g]="Total":v===0?f[g]=y.unix(l[v]).format("DD.MM.YYYY"):f[g]=l[v]}),f}))},[e.columns,e.rows]),u(te,{tableLayout:"auto",className:"w-100",scroll:{x:"100%"},columns:a,dataSource:r,size:"small",rowKey:()=>Math.random().toString(),pagination:{position:"bottom",total:r.length,showTotal:(l,d)=>`${d[0]}-${d[1]} of ${l} items`,showSizeChanger:!0,pageSizeOptions:["10","20","50","100","200"],hideOnSinglePage:r.length<10}})},{RangePicker:ye}=rn;y.updateLocale("en",{week:{dow:1}});const Oi=()=>{const[e,a]=N.useState({}),[i,r]=N.useState({}),[o,l]=N.useState({}),[d,f]=N.useState(!1),[g,v]=N.useState({}),[p,T]=N.useState({}),[P,x]=N.useState(!0),[C,O]=N.useState([]),[rt,ee]=N.useState([]),[k,St]=N.useState([]),[Tt,ft]=N.useState(!1),[mt,lt]=N.useState(!1),[kt,G]=N.useState(!1),[H,it]=N.useState(y().subtract(7,"days").unix()),[W,Rt]=N.useState(y().unix()),[pt,ne]=N.useState({}),{formatMessage:L}=Me(),q=Kn();N.useEffect(()=>{document.title="Dashboard Sales",Lt(H,W),$n().then(async b=>{if(b.status===401){q({type:"user/SET_STATE",payload:{authorized:!1}});return}if(b.status===200){const E=await b.json();l(E)}}),Jn().then(async b=>{if(b.status===401){q({type:"user/SET_STATE",payload:{authorized:!1}});return}if(b.status===200){const E=await b.json();v(E)}})},[q]);const Lt=(b,E)=>{Qn(b,E).then(async _=>{if(_.status===401){q({type:"user/SET_STATE",payload:{authorized:!1}});return}if(_.status===200){const M=await _.json();a(M)}})},zt=(b,E)=>{x(!0),ta(b,E).then(async _=>{if(_.status===401){q({type:"user/SET_STATE",payload:{authorized:!1}});return}if(_.status===200){const M=await _.json();T(M.result.promo)}}).finally(()=>x(!1))},ae=(b,E)=>{ea(b,E).then(async _=>{if(_.status===401){q({type:"user/SET_STATE",payload:{authorized:!1}});return}if(_.status===200){const M=await _.json();r(M)}})},ie=()=>{f(!0),na().then(async b=>{if(b.status===401){q({type:"user/SET_STATE",payload:{authorized:!1}});return}if(b.status===200){const E=await b.json();St(E.months)}}).finally(()=>f(!1))},tt=async b=>{it(b[0].unix()),Rt(b[1].unix())},se=()=>{lt(!0),aa(y.unix(H).format("DD-MM-YYYY"),y.unix(W).format("DD-MM-YYYY")).then(async b=>{if(b.status===200){const E=await b.json();O(E.salesList),ee(E.details)}}).finally(()=>lt(!1))},xt=()=>{ft(!0),ia(y.unix(H).format("DD-MM-YYYY"),y.unix(W).format("DD-MM-YYYY")).then(async b=>{if(b.status===200){const E=await b.json();ne(E),ft(!1)}}).finally(()=>ft(!1))},oe=()=>{G(!0),sa(y.unix(H).format("DD-MM-YYYY"),y.unix(W).format("DD-MM-YYYY")).then(async b=>{if(b.status===200){const E=await b.blob(),_=b.headers.get("Filename");oa.saveAs(E,`${_}`)}}).finally(()=>G(!1))};return u(dt,{roles:["root","admin","sales","salesDirector","finance"],denied:["Dany","Yana","Ksenia"],redirect:!0,to:"/main",children:D("div",{children:[D("div",{className:"row",children:[D("div",{className:"col-lg-6 col-xl-6",children:[D("div",{className:"utils__title mb-3",children:[u(dt,{roles:["sales"],children:u("strong",{className:"text-uppercase font-size-16",children:L({id:"DashboardSales.MyStatistics"})})}),u(dt,{roles:["root","admin","salesDirector"],children:u("strong",{className:"text-uppercase font-size-16",children:L({id:"DashboardSales.AllSales"})})})]}),Object.keys(e).length>0?u(ra,{getSalesMainData:Lt,getSalesActiveOrders:ae,defaultRange:"month",data:e,activeOrders:i,isSales:!0}):u("div",{className:"card",style:{padding:"15px"},children:u(Kt,{})})]}),D("div",{className:"col-lg-6 col-xl-6",children:[u("div",{className:"utils__title mb-3",children:u("strong",{className:"text-uppercase font-size-16",children:L({id:"DashboardSales.ActiveDiscounts"})})}),u(ba,{getPromoStats:zt,data:p,promoStatsLoading:P}),Object.keys(o).length>0?u(Ta,{defaultRange:"month",data:o}):u("div",{className:"card",style:{padding:"15px"},children:u(Kt,{})})]})]}),D("div",{className:"row",children:[u("div",{className:"col-lg-6 col-xl-6",children:D(dt,{roles:["root","admin"],children:[u("div",{className:"utils__title mb-3",children:u("strong",{className:"text-uppercase font-size-16",children:L({id:"DashboardSales.StatisticsBySales"})})}),Object.keys(g).length>0?u(xa,{defaultRange:"month",data:g}):u("div",{className:"card",style:{padding:"15px"},children:u(Kt,{})})]})}),u("div",{className:"col-lg-6 col-xl-6",children:D(dt,{roles:["root","admin"],children:[u("div",{className:"utils__title mb-3",children:u("strong",{className:"text-uppercase font-size-16",children:L({id:"DashboardSales.GlobalChart"})})}),u(oi,{loadGlobalChart:ie,chartLoading:d,defaultType:"all",months:k})]})})]}),u("div",{className:"row",children:D("div",{className:"col-lg-12 col-xl-12",children:[D("div",{className:"utils__title mb-3",children:[u(dt,{roles:["sales"],children:u("strong",{className:"text-uppercase font-size-16",children:L({id:"DashboardSales.MySoldWeeks"})})}),u(dt,{roles:["root","admin","salesDirector"],children:u("strong",{className:"text-uppercase font-size-16",children:L({id:"DashboardSales.AllSoldWeeks"})})})]}),u("div",{className:"card",children:D("div",{className:"card-body",children:[u(ye,{ranges:{"Previous Month":[y().subtract(1,"month").startOf("month"),y().subtract(1,"month").endOf("month")],"This Month":[y().startOf("month"),y().endOf("month")]},defaultValue:[y(H*1e3),y(W*1e3)],format:"DD.MM.YYYY",onChange:tt,style:{marginBottom:"30px",marginRight:"15px"}}),u(qt,{style:{marginBottom:"30px",marginRight:"15px"},type:"primary",onClick:xt,children:L({id:"window.show"})}),u(Ge,{spinning:Tt,children:u(Qt,{gutter:16,children:u(li,{data:pt})})})]})})]})}),u("div",{className:"utils__title mb-3",children:u("strong",{className:"text-uppercase font-size-16",children:L({id:"DashboardSales.GlobalSalesData"})})}),u("div",{className:"row",children:u("div",{className:"col-lg-12 col-xl-12",children:u("div",{className:"card",children:D("div",{className:"card-body",children:[u(ye,{ranges:{"Previous Month":[y().subtract(1,"month").startOf("month"),y().subtract(1,"month").endOf("month")],"This Month":[y().startOf("month"),y().endOf("month")]},defaultValue:[y(H*1e3),y(W*1e3)],format:"DD.MM.YYYY",onChange:tt,style:{marginBottom:"30px",marginRight:"15px"}}),u(qt,{style:{marginBottom:"30px",marginRight:"15px"},type:"primary",onClick:se,children:L({id:"window.show"})}),C.length>0&&u(Ge,{spinning:mt,children:u(ri,{data:C,details:rt})})]})})})}),u("div",{className:"utils__title mb-3",children:u("strong",{className:"text-uppercase font-size-16",children:L({id:"DashboardSales.SalesTargetFulfillmentData"})})}),u("div",{className:"row",children:u("div",{className:"col-lg-12 col-xl-12",children:u("div",{className:"card",children:D("div",{className:"card-body",children:[u(ye,{ranges:{"Previous Month":[y().subtract(1,"month").startOf("month"),y().subtract(1,"month").endOf("month")],"This Month":[y().startOf("month"),y().endOf("month")]},defaultValue:[y(H*1e3),y(W*1e3)],format:"DD.MM.YYYY",onChange:tt,style:{marginRight:"15px"}}),u(qt,{style:{marginRight:"15px"},type:"primary",onClick:oe,loading:kt,children:L({id:"DashboardSales.Download"})})]})})})})]})})};export{Oi as default};
